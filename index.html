<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Advanced Chit Fund Calculator</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); min-height: 100vh; padding: 20px; }
        .container { max-width: 1400px; margin: 0 auto; background: white; border-radius: 15px; box-shadow: 0 10px 30px rgba(0,0,0,0.2); overflow: hidden; }
        .header { background: linear-gradient(135deg, #667eea, #764ba2); color: white; padding: 20px; text-align: center; }
        .language-selector { position: absolute; top: 20px; right: 20px; }
        .language-selector select { padding: 8px 12px; border: none; border-radius: 5px; background: rgba(255,255,255,0.9); font-weight: 600; }
        .main-content { display: flex; flex-wrap: wrap; }
        .input-panel { flex: 1; min-width: 400px; padding: 30px; background: #f8f9fa; }
        .output-panel { flex: 1; min-width: 400px; padding: 30px; background: #1a1a2e; color: white; }
        .tabs { text-align: center; margin-bottom: 20px; }
        .tab-btn { background: rgba(255,255,255,0.2); color: white; padding: 12px 30px; border: none; border-radius: 25px; margin: 0 10px; cursor: pointer; font-weight: 600; transition: all 0.3s; }
        .tab-btn:nth-child(1) { background: rgba(76, 175, 80, 0.3); }
        .tab-btn:nth-child(2) { background: rgba(33, 150, 243, 0.3); }
        .tab-btn:nth-child(3) { background: rgba(255, 152, 0, 0.3); }
        .tab-btn:nth-child(4) { background: rgba(156, 39, 176, 0.3); }
        .tab-btn:nth-child(1).active, .tab-btn:nth-child(1):hover { background: #4CAF50; color: black; transform: translateY(-2px); }
        .tab-btn:nth-child(2).active, .tab-btn:nth-child(2):hover { background: #2196F3; color: black; transform: translateY(-2px); }
        .tab-btn:nth-child(3).active, .tab-btn:nth-child(3):hover { background: #FF9800; color: black; transform: translateY(-2px); }
        .tab-btn:nth-child(4).active, .tab-btn:nth-child(4):hover { background: #9C27B0; color: white; transform: translateY(-2px); }
        .tab-btn.active, .tab-btn:hover { background: linear-gradient(145deg, #667eea, #764ba2); transform: translateY(-2px); }
        .tab-content { display: none; padding: 30px; }
        .tab-content.active { display: block; }
        #calculator { background: linear-gradient(135deg, #e8f5e8, #f0f8f0); }
        #analysis { background: linear-gradient(135deg, #e8f4fd, #f0f8ff); }
        #comparison { background: linear-gradient(135deg, #fff8e1, #fffbf0); }
        #notes { background: linear-gradient(135deg, #f3e5f5, #faf5ff); }
        .form-group { margin-bottom: 20px; }
        .form-group label { display: block; margin-bottom: 5px; font-weight: 600; color: #495057; }
        .form-group input, .form-group select { width: 100%; padding: 12px; border: 2px solid #dee2e6; border-radius: 8px; font-size: 14px; transition: border-color 0.3s; }
        .form-group input:focus, .form-group select:focus { outline: none; border-color: #667eea; }
        .radio-group { display: flex; gap: 20px; margin: 15px 0; }
        .radio-group label { display: flex; align-items: center; gap: 8px; cursor: pointer; }
        .slider-container { margin: 15px 0; }
        .slider { width: 100%; height: 6px; border-radius: 3px; background: #ddd; outline: none; }
        .result-card { background: rgba(255,255,255,0.1); padding: 20px; border-radius: 10px; margin: 15px 0; }
        .result-value { font-size: 24px; font-weight: bold; color: #ffd700; text-align: center; margin: 10px 0; }
        .result-label { font-size: 14px; text-align: center; opacity: 0.9; }
        .btn { background: linear-gradient(135deg, #667eea, #764ba2); color: white; border: none; padding: 12px 24px; border-radius: 8px; cursor: pointer; font-weight: 600; transition: transform 0.2s; margin: 5px; }
        .btn:hover { transform: translateY(-2px); }
        .btn-secondary { background: #6c757d; }
        .btn-success { background: #28a745; }
        .btn-danger { background: #dc3545; }
        .table { width: 100%; border-collapse: collapse; margin: 20px 0; }
        .table th, .table td { padding: 12px; text-align: center; border-bottom: 1px solid #dee2e6; }
        .table th { background: #f8f9fa; font-weight: 600; }
        .table tr:hover { background: #f8f9fa; }
        .profit { color: #28a745; font-weight: bold; }
        .loss { color: #dc3545; font-weight: bold; }
        .highlight { background: #fff3cd; font-weight: bold; }
        .editable { background: #fff3cd !important; border: 1px solid #ffc107; }
        .edit-input { width: 80px; padding: 2px; border: 1px solid #ccc; border-radius: 3px; text-align: center; font-size: 11px; }
        @media (max-width: 768px) { .main-content { flex-direction: column; } .input-panel, .output-panel { min-width: auto; } }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <div class="language-selector">
                <select id="languageSelector" onchange="changeLanguage()">
                    <option value="en">English</option>
                    <option value="hi">рд╣рд┐рдВрджреА</option>
                    <option value="te">р░др▒Жр░▓р▒Бр░Чр▒Б</option>
                    <option value="ta">родрооро┐ро┤рпН</option>
                    <option value="kn">р▓Хр▓ир│Нр▓ир▓б</option>
                    <option value="ml">р┤ор┤▓р┤пр┤╛р┤│р┤В</option>
                    <option value="gu">ркЧрлБркЬрк░рк╛ркдрлА</option>
                    <option value="mr">рдорд░рд╛рдареА</option>
                    <option value="bn">ржмрж╛ржВрж▓рж╛</option>
                    <option value="pa">рикрй░риЬри╛римрйА</option>
                    <option value="or">рмУрмбрм╝рм┐рмЖ</option>
                    <option value="as">ржЕрж╕ржорзАржпрж╝рж╛</option>
                </select>
            </div>
            <h1 data-translate="title">Advanced Chit Fund Calculator</h1>
            <p data-translate="subtitle">Calculate bidding rates, profits, and find the best month to bid</p>
        </div>

        <div class="tabs">
            <button class="tab-btn active" onclick="showTab('calculator')" data-translate="calculator">ЁЯзо Calculator</button>
            <button class="tab-btn" onclick="showTab('analysis')" data-translate="analysis_report">ЁЯУК Analysis Report</button>
            <button class="tab-btn" onclick="showTab('comparison')" data-translate="best_month_analysis">ЁЯПЖ Best Month Analysis</button>
            <button class="tab-btn" onclick="showTab('notes')" data-translate="notes">ЁЯУЭ Notes</button>
        </div>

        <div id="calculator" class="tab-content active">
            <div class="main-content" style="background: transparent;">
                <div class="input-panel">
                    <h3 data-translate="chit_details">Chit Fund Details</h3>
                    
                    <div class="form-group">
                        <label data-translate="chit_amount">Chit Amount (тВ╣)</label>
                        <input type="text" id="chitAmount" value="40,00,000" onblur="formatInput(this)" onfocus="removeCommas(this)">
                    </div>

                    <div class="form-group">
                        <label data-translate="total_months">Total Months</label>
                        <input type="number" id="totalMonths" value="20" min="1" max="100">
                    </div>

                    <div class="form-group">
                        <label data-translate="commission">Commission (%)</label>
                        <input type="number" id="commission" value="4" step="0.1" min="0" max="20">
                    </div>

                    <div class="form-group">
                        <label data-translate="monthly_installment">Monthly Installment (тВ╣)</label>
                        <input type="text" id="monthlyInstallment" value="2,00,000" onblur="formatInput(this)" onfocus="removeCommas(this)">
                    </div>

                    <h3 data-translate="bidding_details">Bidding Details</h3>

                    <div class="form-group">
                        <label data-translate="current_month">Current Month</label>
                        <input type="number" id="currentMonth" value="1" min="1">
                    </div>

                    <div class="radio-group">
                        <label><input type="radio" name="bidType" value="amount" checked> <span data-translate="bid_amount">Bid Amount</span></label>
                        <label><input type="radio" name="bidType" value="rate"> <span data-translate="bid_rate">Bid Rate</span></label>
                    </div>

                    <div class="form-group" id="bidAmountGroup">
                        <label data-translate="bid_amount">Bid Amount (тВ╣)</label>
                        <input type="text" id="bidAmount" value="12,70,000" onblur="formatInput(this)" onfocus="removeCommas(this)">
                        <div class="slider-container">
                            <input type="range" class="slider" id="bidAmountSlider" min="0" max="2000000" value="1270000">
                        </div>
                    </div>

                    <div class="form-group" id="bidRateGroup" style="display: none;">
                        <label data-translate="bid_rate">Bid Rate (%)</label>
                        <input type="number" id="bidRate" value="10" step="0.1" min="0" max="50">
                        <div class="slider-container">
                            <input type="range" class="slider" id="bidRateSlider" min="0" max="50" value="10" step="0.1">
                        </div>
                    </div>

                    <button class="btn" onclick="calculate()">ЁЯФв Calculate</button>
                </div>

                <div class="output-panel">
                    <h3 data-translate="results">Results</h3>
                    
                    <div class="result-card">
                        <div class="result-label" data-translate="bidding_rate">Bidding Rate</div>
                        <div class="result-value" id="biddingRate">0.00%</div>
                    </div>

                    <div class="result-card">
                        <div class="result-label" data-translate="amount_received">Amount Received by Bidder</div>
                        <div class="result-value" id="amountReceived">тВ╣0</div>
                    </div>

                    <div class="result-card">
                        <div class="result-label" data-translate="dividend_per_member">Dividend per Member</div>
                        <div class="result-value" id="dividendPerMember">тВ╣0</div>
                    </div>

                    <div class="result-card">
                        <div class="result-label" data-translate="net_installment">Net Installment</div>
                        <div class="result-value" id="netInstallment">тВ╣0</div>
                    </div>

                    <div class="result-card">
                        <div class="result-label" data-translate="savings_percentage">Monthly Savings</div>
                        <div class="result-value" id="savingsPercentage">0.00%</div>
                    </div>

                    <div class="result-card">
                        <div class="result-label" data-translate="organizer_commission">Organizer Commission</div>
                        <div class="result-value" id="organizerCommission">тВ╣0</div>
                    </div>

                    <button class="btn btn-success" onclick="shareResult()">ЁЯУд Share Result</button>
                    <button class="btn btn-secondary" onclick="shareAsImage()">ЁЯЦ╝я╕П Share Image</button>
                    <button class="btn btn-secondary" onclick="saveResult()">ЁЯТ╛ Save</button>
                </div>
            </div>
        </div>

        <div id="analysis" class="tab-content">
            <div style="padding: 30px; background: transparent;">
                <h3 data-translate="monthly_analysis">Chit Fund Analysis Report (Monthly)</h3>
                
                <div style="background: rgba(248,249,250,0.7); padding: 15px; border-radius: 8px; margin-bottom: 20px;">
                    <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 15px; margin-bottom: 15px;">
                        <div>
                            <label style="font-size: 12px; font-weight: bold; color: #4a5568;" data-translate="chit_amount">Chit Amount (тВ╣):</label>
                            <input type="text" id="analysisChitAmount" value="40,00,000" style="width: 100%; padding: 4px; border: 1px solid #667eea; border-radius: 3px; font-size: 12px;" onblur="formatInput(this)" onfocus="removeCommas(this)">
                        </div>
                        <div>
                            <label style="font-size: 12px; font-weight: bold; color: #4a5568;" data-translate="commission">Commission (%):</label>
                            <input type="number" id="analysisCommission" value="4.00" step="0.01" style="width: 100%; padding: 4px; border: 1px solid #667eea; border-radius: 3px; font-size: 12px;">
                        </div>
                        <div>
                            <label style="font-size: 12px; font-weight: bold; color: #4a5568;" data-translate="total_months">Total Months:</label>
                            <input type="number" id="analysisTotalMonths" value="20" min="1" style="width: 100%; padding: 4px; border: 1px solid #667eea; border-radius: 3px; font-size: 12px;">
                        </div>
                        <div>
                            <label style="font-size: 12px; font-weight: bold; color: #4a5568;" data-translate="current_month">Current Month:</label>
                            <input type="number" id="analysisCurrentMonth" value="1" min="1" style="width: 100%; padding: 4px; border: 1px solid #667eea; border-radius: 3px; font-size: 12px;">
                        </div>
                        <div>
                            <label style="font-size: 12px; font-weight: bold; color: #4a5568;" data-translate="monthly_installment">Auction Amount (тВ╣):</label>
                            <input type="text" id="analysisAuctionAmount" value="2,00,000" style="width: 100%; padding: 4px; border: 1px solid #667eea; border-radius: 3px; font-size: 12px;" onblur="formatInput(this)" onfocus="removeCommas(this)">
                        </div>
                        <div>
                            <label style="font-size: 12px; font-weight: bold; color: #4a5568;" data-translate="bid_amount">Bid Amount (тВ╣):</label>
                            <input type="text" id="analysisBidAmount" value="12,70,000" style="width: 100%; padding: 4px; border: 1px solid #667eea; border-radius: 3px; font-size: 12px;" onblur="formatInput(this)" onfocus="removeCommas(this)">
                        </div>
                    </div>
                    <div style="text-align: center;">
                        <label style="margin-right: 10px; font-weight: bold; font-size: 12px;" data-translate="net_installment">EMI Monthly Paid (тВ╣):</label>
                        <span id="emiMonthlyPaid" style="background: #f8f9fa; padding: 4px 8px; border: 1px solid #dee2e6; border-radius: 3px; font-size: 12px; margin-right: 15px; color: #495057;">тВ╣0</span>
                        <button onclick="submitValues()" style="background: #28a745; color: white; padding: 2px 6px; border: none; border-radius: 3px; cursor: pointer; font-size: 11px; width: auto; margin-right: 10px;">тЬУ Submit</button>
                        <button onclick="fetchToBestMonth()" style="background: #17a2b8; color: white; padding: 2px 6px; border: none; border-radius: 3px; cursor: pointer; font-size: 11px; width: auto; margin-right: 10px;">ЁЯУК Fetch to Best Month</button>
                        <button onclick="toggleEdit()" id="editBtn" style="background: #667eea; color: white; padding: 2px 6px; border: none; border-radius: 3px; cursor: pointer; font-size: 11px; width: auto; margin-right: 10px;">тЬПя╕П Edit</button>
                        <button onclick="loadSampleData()" style="background: #38a169; color: white; padding: 2px 6px; border: none; border-radius: 3px; cursor: pointer; font-size: 11px; width: auto; margin-right: 10px;">ЁЯУД Sample Data</button>
                        <button onclick="clearAnalysisData()" style="background: #e53e3e; color: white; padding: 2px 6px; border: none; border-radius: 3px; cursor: pointer; font-size: 11px; width: auto; margin-right: 10px;">ЁЯЧСя╕П Clear</button>
                        <button onclick="exportPDF()" style="background: #dc3545; color: white; padding: 2px 6px; border: none; border-radius: 3px; cursor: pointer; font-size: 11px; width: auto; margin-right: 10px;">ЁЯУД Export PDF</button>
                        <button onclick="exportCSV()" style="background: #28a745; color: white; padding: 2px 6px; border: none; border-radius: 3px; cursor: pointer; font-size: 11px; width: auto;">тмЗя╕П Download CSV</button>
                    </div>
                </div>

                <table class="table" id="analysisTable" style="font-size: 11px;">
                    <thead>
                        <tr>
                            <th data-translate="month">Month</th>
                            <th data-translate="bid_amount">BID Amount</th>
                            <th data-translate="organizer_commission">Dealer Commission</th>
                            <th data-translate="net_installment">Payable Installment</th>
                            <th data-translate="amount_received">Bidder Gets</th>
                            <th data-translate="profit_loss">Profit/Loss</th>
                            <th data-translate="monthly_rate">Monthly %</th>
                            <th data-translate="total_percentage">Total Percentage Profit/Loss (<span id="totalMonthsHeader">20</span> Months)</th>
                            <th data-translate="annual_rate">Annual Simple Interest Rate</th>
                        </tr>
                    </thead>
                    <tbody id="analysisBody">
                        <tr><td colspan="9" style="text-align: center; padding: 40px;">Enter values and click Submit to generate analysis</td></tr>
                    </tbody>
                    <tfoot>
                        <tr style="background: #f1f5f9; font-weight: bold;">
                            <td data-translate="total">Total</td>
                            <td>-</td>
                            <td>-</td>
                            <td id="totalPayable">тВ╣0</td>
                            <td>-</td>
                            <td>-</td>
                            <td>-</td>
                            <td>-</td>
                            <td>-</td>
                        </tr>
                    </tfoot>
                </table>
            </div>
        </div>

        <div id="comparison" class="tab-content">
            <div style="padding: 30px; background: transparent;">
                <h3 data-translate="best_month_analysis">Best Month Analysis</h3>
                
                <div style="margin: 20px 0;">
                    <label data-translate="external_interest">External Interest Rate (%):</label>
                    <input type="number" id="externalRate" value="12" step="0.1" min="0" max="50" onchange="generateComparison()" style="width: 100px; margin-left: 10px;">
                    <button onclick="downloadBestMonthCSV()" style="background: #28a745; color: white; padding: 4px 8px; border: none; border-radius: 4px; cursor: pointer; margin-left: 10px; font-size: 11px;">тмЗя╕П CSV</button>
                    <button onclick="downloadBestMonthPDF()" style="background: #dc3545; color: white; padding: 4px 8px; border: none; border-radius: 4px; cursor: pointer; margin-left: 5px; font-size: 11px;">ЁЯУД PDF</button>
                    <button onclick="downloadBestMonthExcel()" style="background: #17a2b8; color: white; padding: 4px 8px; border: none; border-radius: 4px; cursor: pointer; margin-left: 5px; font-size: 11px;">ЁЯУИ Excel</button>
                </div>

                <div id="bestMonthResult" style="background: #d4edda; padding: 20px; border-radius: 10px; margin: 20px 0; text-align: center; display: none;">
                    <h4 data-translate="recommended_month">ЁЯПЖ Recommended Month: <span id="bestMonth">-</span></h4>
                    <p data-translate="max_benefit">Maximum Benefit: <span id="maxBenefit">тВ╣0</span></p>
                </div>

                <table class="table" id="comparisonTable">
                    <thead>
                        <tr>
                            <th data-translate="month">Month</th>
                            <th data-translate="bid_amount">Bid Amount</th>
                            <th data-translate="amount_received">Amount Received</th>
                            <th data-translate="chit_benefit">Chit Benefit</th>
                            <th data-translate="external_benefit">External Benefit</th>
                            <th>External Benefit %</th>
                            <th data-translate="total_benefit">Total Benefit</th>
                            <th>Total %</th>
                            <th>Monthly %</th>
                            <th>Annual %</th>
                            <th data-translate="rank">Rank</th>
                        </tr>
                    </thead>
                    <tbody id="comparisonBody">
                    </tbody>
                </table>
            </div>
        </div>
    </div>

        <div id="notes" class="tab-content">
            <div style="padding: 30px; background: transparent;">
                <h3 data-translate="notes_title">Chit Fund Details</h3>
                
                <div style="background: rgba(248,249,250,0.7); padding: 20px; border-radius: 10px; margin: 20px 0;">
                    <h4 data-translate="chit_details_header">Chit Fund Details</h4>
                    <p data-translate="chit_amount_desc"><strong>Chit Amount (Total Value):</strong> тВ╣40,00,000</p>
                    <p data-translate="total_months_desc"><strong>Total Months:</strong> 20</p>
                    <p data-translate="commission_desc"><strong>Organizer Commission:</strong> тВ╣1,60,000 (which is 4% of the total chit amount)</p>
                    <p data-translate="installment_desc"><strong>Monthly Installment:</strong> тВ╣2,00,000 per member.</p>
                </div>

                <div style="background: rgba(230,243,255,0.7); padding: 20px; border-radius: 10px; margin: 20px 0;">
                    <h4 data-translate="bidding_results_header">Bidding and Results</h4>
                    <p data-translate="bidding_explanation">Here is a step-by-step explanation of the auction and its outcomes:</p>
                    
                    <p data-translate="amount_received_desc"><strong>Amount Received by Bidder:</strong> The winning bidder received тВ╣27,30,000.</p>
                    
                    <p data-translate="bid_amount_desc"><strong>Bid Amount:</strong> To get this amount, the winner agreed to a discount (the bid). This bid amount is calculated by subtracting the received amount from the total chit value.</p>
                    <p style="text-align: center; background: #fff; padding: 10px; border-radius: 5px; margin: 10px 0;">тВ╣40,00,000 (Total Chit) - тВ╣27,30,000 (Received Amount) = тВ╣12,70,000</p>
                    
                    <p data-translate="bid_rate_desc"><strong>Bid Rate:</strong> This bid amount represents a 31.75% discount on the total chit amount.</p>
                    <p style="text-align: center; background: #fff; padding: 10px; border-radius: 5px; margin: 10px 0;">(тВ╣12,70,000 ├╖ тВ╣40,00,000) ├Ч 100 = 31.75%</p>
                    
                    <p data-translate="dividend_desc"><strong>Dividend per Member:</strong> The total amount available for a dividend is the bid amount minus the organizer's commission. This amount is then shared equally among all 20 members.</p>
                    <p style="text-align: center; background: #fff; padding: 10px; border-radius: 5px; margin: 10px 0;">(тВ╣12,70,000 (Bid Amount) - тВ╣1,60,000 (Commission)) ├╖ 20 (Members) = тВ╣55,500</p>
                    
                    <p data-translate="net_installment_desc"><strong>Net Installment:</strong> Each member's monthly installment is reduced by the dividend.</p>
                </div>
            </div>
        </div>
    </div>

    <script>
        const translations = {
            en: {
                title: "Advanced Chit Fund Calculator",
                subtitle: "Calculate bidding rates, profits, and find the best month to bid",
                calculator: "Calculator",
                analysis_report: "Analysis Report",
                best_month_analysis: "Best Month Analysis",
                notes: "Notes",
                analysis: "ЁЯУК Analysis",
                comparison: "ЁЯПЖ Best Month",
                chit_details: "Chit Fund Details",
                chit_amount: "Chit Amount (тВ╣)",
                total_months: "Total Months",
                commission: "Commission (%)",
                monthly_installment: "Monthly Installment (тВ╣)",
                bidding_details: "Bidding Details",
                current_month: "Current Month",
                bid_amount: "Bid Amount",
                bid_rate: "Bid Rate",
                calculate: "Calculate",
                results: "Results",
                bidding_rate: "Bidding Rate",
                amount_received: "Amount Received by Bidder",
                dividend_per_member: "Dividend per Member",
                net_installment: "Net Installment",
                savings_percentage: "Monthly Savings",
                organizer_commission: "Organizer Commission",
                share: "Share Result",
                save: "Save",
                monthly_analysis: "Monthly Analysis Report",
                generate_analysis: "Generate Analysis",
                export_pdf: "Export PDF",
                export_csv: "Export CSV",
                month: "Month",
                profit_loss: "Profit/Loss",
                roi: "ROI %",
                click_generate: "Click \"Generate Analysis\" to view monthly breakdown",
                best_month_analysis: "Best Month Analysis",
                external_interest: "External Interest Rate (%)",
                analyze: "Analyze",
                recommended_month: "ЁЯПЖ Recommended Month:",
                max_benefit: "Maximum Benefit:",
                chit_benefit: "Chit Benefit",
                external_benefit: "External Benefit",
                total_benefit: "Total Benefit",
                rank: "Rank",
                click_analyze: "Click \"Analyze\" to find the best month",
                notes_title: "Chit Fund Details",
                chit_details_header: "Chit Fund Details",
                chit_amount_desc: "Chit Amount (Total Value): тВ╣40,00,000",
                total_months_desc: "Total Months: 20",
                commission_desc: "Organizer Commission: тВ╣1,60,000 (which is 4% of the total chit amount)",
                installment_desc: "Monthly Installment: тВ╣2,00,000 per member.",
                bidding_results_header: "Bidding and Results",
                bidding_explanation: "Here is a step-by-step explanation of the auction and its outcomes:",
                amount_received_desc: "Amount Received by Bidder: The winning bidder received тВ╣27,30,000.",
                bid_amount_desc: "Bid Amount: To get this amount, the winner agreed to a discount (the bid). This bid amount is calculated by subtracting the received amount from the total chit value.",
                bid_rate_desc: "Bid Rate: This bid amount represents a 31.75% discount on the total chit amount.",
                dividend_desc: "Dividend per Member: The total amount available for a dividend is the bid amount minus the organizer's commission. This amount is then shared equally among all 20 members.",
                net_installment_desc: "Net Installment: Each member's monthly installment is reduced by the dividend.",
                monthly_rate: "Monthly %",
                total_percentage: "Total Percentage",
                annual_rate: "Annual Rate",
                total: "Total"
            },
            te: {
                title: "р░Ер░зр▒Бр░ир░╛р░др░и р░Ър░┐р░Яр▒Н р░лр░Вр░бр▒Н р░Хр░╛р░▓р░┐р░Хр▒Нр░пр▒Бр░▓р▒Зр░Яр░░р▒Н",
                subtitle: "р░мр░┐р░бр▒Нр░бр░┐р░Вр░Чр▒Н р░░р▒Зр░Яр▒Нр░▓р▒Б, р░▓р░╛р░нр░╛р░▓р░ир▒Б р░▓р▒Жр░Хр▒Нр░Хр░┐р░Вр░Ър░Вр░бр░┐ р░ор░░р░┐р░пр▒Б р░мр░┐р░бр▒Н р░Ър▒Зр░пр░бр░╛р░ир░┐р░Хр░┐ р░Йр░др▒Нр░др░о р░ир▒Жр░▓р░ир▒Б р░Хр░ир▒Бр░Чр▒Кр░ир░Вр░бр░┐",
                calculator: "р░Хр░╛р░▓р░┐р░Хр▒Нр░пр▒Бр░▓р▒Зр░Яр░░р▒Н",
                analysis_report: "р░╡р░┐р░╢р▒Нр░▓р▒Зр░╖р░г р░ир░┐р░╡р▒Зр░жр░┐р░Х",
                best_month_analysis: "р░Йр░др▒Нр░др░о р░ир▒Жр░▓ р░╡р░┐р░╢р▒Нр░▓р▒Зр░╖р░г",
                notes: "р░Чр░ор░ир░┐р░Хр░▓р▒Б",
                analysis: "ЁЯУК р░╡р░┐р░╢р▒Нр░▓р▒Зр░╖р░г",
                comparison: "ЁЯПЖ р░Йр░др▒Нр░др░о р░ир▒Жр░▓",
                chit_details: "р░Ър░┐р░Яр▒Н р░лр░Вр░бр▒Н р░╡р░┐р░╡р░░р░╛р░▓р▒Б",
                chit_amount: "р░Ър░┐р░Яр▒Н р░ор▒Кр░др▒Нр░др░В (тВ╣)",
                total_months: "р░ор▒Кр░др▒Нр░др░В р░ир▒Жр░▓р░▓р▒Б",
                commission: "р░Хр░ор░┐р░╖р░ир▒Н (%)",
                monthly_installment: "р░ир▒Жр░▓р░╡р░╛р░░р▒А р░╡р░╛р░пр░┐р░жр░╛ (тВ╣)",
                bidding_details: "р░мр░┐р░бр▒Нр░бр░┐р░Вр░Чр▒Н р░╡р░┐р░╡р░░р░╛р░▓р▒Б",
                current_month: "р░кр▒Нр░░р░╕р▒Нр░др▒Бр░д р░ир▒Жр░▓",
                bid_amount: "р░мр░┐р░бр▒Н р░ор▒Кр░др▒Нр░др░В",
                bid_rate: "р░мр░┐р░бр▒Н р░░р▒Зр░Яр▒Н",
                calculate: "р░▓р▒Жр░Хр▒Нр░Хр░┐р░Вр░Ър░Вр░бр░┐",
                results: "р░лр░▓р░┐р░др░╛р░▓р▒Б",
                bidding_rate: "р░мр░┐р░бр▒Нр░бр░┐р░Вр░Чр▒Н р░░р▒Зр░Яр▒Н",
                amount_received: "р░мр░┐р░бр▒Нр░бр░░р▒Н р░кр▒Кр░Вр░жр░┐р░и р░ор▒Кр░др▒Нр░др░В",
                dividend_per_member: "р░╕р░нр▒Нр░пр▒Бр░ир░┐р░Хр░┐ р░бр░┐р░╡р░┐р░бр▒Жр░Вр░бр▒Н",
                net_installment: "р░ир▒Жр░Яр▒Н р░╡р░╛р░пр░┐р░жр░╛",
                savings_percentage: "р░ир▒Жр░▓р░╡р░╛р░░р▒А р░кр▒Кр░жр▒Бр░кр▒Бр░▓р▒Б",
                organizer_commission: "р░ир░┐р░░р▒Нр░╡р░╛р░╣р░Хр▒Бр░бр░┐ р░Хр░ор░┐р░╖р░ир▒Н",
                share: "р░лр░▓р░┐р░др░В р░╖р▒Зр░░р▒Н р░Ър▒Зр░пр░Вр░бр░┐",
                save: "р░╕р▒Зр░╡р▒Н р░Ър▒Зр░пр░Вр░бр░┐",
                monthly_analysis: "р░ир▒Жр░▓р░╡р░╛р░░р▒А р░╡р░┐р░╢р▒Нр░▓р▒Зр░╖р░г р░ир░┐р░╡р▒Зр░жр░┐р░Х",
                generate_analysis: "р░╡р░┐р░╢р▒Нр░▓р▒Зр░╖р░г р░░р▒Вр░кр▒Кр░Вр░жр░┐р░Вр░Ър░Вр░бр░┐",
                export_pdf: "PDF р░Ор░Хр▒Нр░╕р▒Нр░кр▒Лр░░р▒Нр░Яр▒Н",
                export_csv: "CSV р░Ор░Хр▒Нр░╕р▒Нр░кр▒Лр░░р▒Нр░Яр▒Н",
                month: "р░ир▒Жр░▓",
                profit_loss: "р░▓р░╛р░нр░В/р░ир░╖р▒Нр░Яр░В",
                roi: "ROI %",
                click_generate: "р░ир▒Жр░▓р░╡р░╛р░░р▒А р░╡р░┐р░╡р░░р░г р░Ър▒Вр░бр░Яр░╛р░ир░┐р░Хр░┐ \"р░╡р░┐р░╢р▒Нр░▓р▒Зр░╖р░г р░░р▒Вр░кр▒Кр░Вр░жр░┐р░Вр░Ър░Вр░бр░┐\" р░Хр▒Нр░▓р░┐р░Хр▒Н р░Ър▒Зр░пр░Вр░бр░┐",
                best_month_analysis: "р░Йр░др▒Нр░др░о р░ир▒Жр░▓ р░╡р░┐р░╢р▒Нр░▓р▒Зр░╖р░г",
                external_interest: "р░мр░╛р░╣р▒Нр░п р░╡р░бр▒Нр░бр▒А р░░р▒Зр░Яр▒Б (%)",
                analyze: "р░╡р░┐р░╢р▒Нр░▓р▒Зр░╖р░┐р░Вр░Ър░Вр░бр░┐",
                recommended_month: "ЁЯПЖ р░╕р░┐р░лр░╛р░░р▒Нр░╕р▒Б р░Ър▒Зр░╕р░┐р░и р░ир▒Жр░▓:",
                max_benefit: "р░Чр░░р░┐р░╖р▒Нр░Я р░кр▒Нр░░р░пр▒Лр░Ьр░ир░В:",
                chit_benefit: "р░Ър░┐р░Яр▒Н р░кр▒Нр░░р░пр▒Лр░Ьр░ир░В",
                external_benefit: "р░мр░╛р░╣р▒Нр░п р░кр▒Нр░░р░пр▒Лр░Ьр░ир░В",
                total_benefit: "р░ор▒Кр░др▒Нр░др░В р░кр▒Нр░░р░пр▒Лр░Ьр░ир░В",
                rank: "р░░р▒Нр░пр░╛р░Вр░Хр▒Н",
                click_analyze: "р░Йр░др▒Нр░др░о р░ир▒Жр░▓р░ир▒Б р░Хр░ир▒Бр░Чр▒Кр░ир░бр░╛р░ир░┐р░Хр░┐ \"р░╡р░┐р░╢р▒Нр░▓р▒Зр░╖р░┐р░Вр░Ър░Вр░бр░┐\" р░Хр▒Нр░▓р░┐р░Хр▒Н р░Ър▒Зр░пр░Вр░бр░┐",
                notes_title: "р░Ър░┐р░Яр▒Н р░лр░Вр░бр▒Н р░╡р░┐р░╡р░░р░╛р░▓р▒Б",
                chit_details_header: "р░Ър░┐р░Яр▒Н р░лр░Вр░бр▒Н р░╡р░┐р░╡р░░р░╛р░▓р▒Б",
                chit_amount_desc: "р░Ър░┐р░Яр▒Н р░ор▒Кр░др▒Нр░др░В (р░ор▒Кр░др▒Нр░др░В р░╡р░┐р░▓р▒Бр░╡): тВ╣40,00,000",
                total_months_desc: "р░ор▒Кр░др▒Нр░др░В р░ир▒Жр░▓р░▓р▒Б: 20",
                commission_desc: "р░Жр░░р▒Нр░Чр░ир▒Ир░Ьр░░р▒Н р░Хр░ор▒Ар░╖р░ир▒Н: тВ╣1,60,000 (р░Зр░жр░┐ р░ор▒Кр░др▒Нр░др░В р░Ър░┐р░Яр▒Н р░ор▒Кр░др▒Нр░др░Вр░▓р▒Л 4%)",
                installment_desc: "р░ир▒Жр░▓р░╡р░╛р░░р▒А р░╡р░╛р░пр░┐р░жр░╛: р░╕р░нр▒Нр░пр▒Бр░бр░┐р░Хр░┐ тВ╣2,00,000.",
                bidding_results_header: "р░мр░┐р░бр▒Нр░бр░┐р░Вр░Чр▒Н р░ор░░р░┐р░пр▒Б р░лр░▓р░┐р░др░╛р░▓р▒Б",
                bidding_explanation: "р░╡р▒Зр░▓р░В р░ор░░р░┐р░пр▒Б р░жр░╛р░ир░┐ р░лр░▓р░┐р░др░╛р░▓ р░Чр▒Бр░░р░┐р░Вр░Ър░┐ р░жр░╢р░▓р░╡р░╛р░░р▒Ар░Чр░╛ р░╡р░┐р░╡р░░р░г:",
                amount_received_desc: "р░мр░┐р░бр▒Нр░бр░░р▒Н р░кр▒Кр░Вр░жр░┐р░и р░ор▒Кр░др▒Нр░др░В: р░Чр▒Жр░▓р▒Бр░кр▒Б р░мр░┐р░бр▒Нр░бр░░р▒Н тВ╣27,30,000 р░кр▒Кр░Вр░жр░╛р░░р▒Б.",
                bid_amount_desc: "р░мр░┐р░бр▒Н р░ор▒Кр░др▒Нр░др░В: р░И р░ор▒Кр░др▒Нр░др░В р░кр▒Кр░Вр░жр░бр░╛р░ир░┐р░Хр░┐, р░Чр▒Жр░▓р▒Бр░кр▒Б р░╡р▒Нр░пр░Хр▒Нр░др░┐ р░Тр░Х р░др░Чр▒Нр░Чр░┐р░Вр░кр▒Бр░Хр▒Б (р░мр░┐р░бр▒Н) р░Ер░Вр░Чр▒Ар░Хр░░р░┐р░Вр░Ър░╛р░░р▒Б. р░И р░мр░┐р░бр▒Н р░ор▒Кр░др▒Нр░др░В р░ор▒Кр░др▒Нр░др░В р░Ър░┐р░Яр▒Н р░╡р░┐р░▓р▒Бр░╡ р░ир▒Бр░Вр░бр░┐ р░кр▒Кр░Вр░жр░┐р░и р░ор▒Кр░др▒Нр░др░В р░др▒Ар░╕р░┐ р░▓р▒Жр░Хр▒Нр░Хр░┐р░Вр░Ър░мр░бр▒Бр░др▒Бр░Вр░жр░┐.",
                bid_rate_desc: "р░мр░┐р░бр▒Н р░░р▒Зр░Яр▒Н: р░И р░мр░┐р░бр▒Н р░ор▒Кр░др▒Нр░др░В р░ор▒Кр░др▒Нр░др░В р░Ър░┐р░Яр▒Н р░ор▒Кр░др▒Нр░др░Вр░▓р▒Л 31.75% р░др░Чр▒Нр░Чр░┐р░Вр░кр▒Бр░ир░┐ р░кр▒Нр░░р░др░┐р░ир░┐р░зр░┐р░╕р▒Нр░др▒Бр░Вр░жр░┐.",
                dividend_desc: "р░╕р░нр▒Нр░пр▒Бр░бр░┐р░Хр░┐ р░бр░┐р░╡р░┐р░бр▒Жр░Вр░бр▒Н: р░бр░┐р░╡р░┐р░бр▒Жр░Вр░бр▒Н р░Хр▒Лр░╕р░В р░▓р░нр▒Нр░пр░ор▒Ир░и р░ор▒Кр░др▒Нр░др░В р░ор▒Кр░др▒Нр░др░В р░мр░┐р░бр▒Н р░ор▒Кр░др▒Нр░др░В р░ир▒Бр░Вр░бр░┐ р░Жр░░р▒Нр░Чр░ир▒Ир░Ьр░░р▒Н р░Хр░ор▒Ар░╖р░ир▒Н р░др▒Ар░╕р░┐р░╡р▒Зр░╕р░┐р░ир░жр░┐. р░И р░ор▒Кр░др▒Нр░др░В 20 р░ор░Вр░жр░┐ р░╕р░нр▒Нр░пр▒Бр░▓р░▓р▒Л р░╕р░ор░╛р░ир░Вр░Чр░╛ р░кр░Вр░Ър░мр░бр▒Бр░др▒Бр░Вр░жр░┐.",
                net_installment_desc: "р░ир▒Жр░Яр▒Н р░╡р░╛р░пр░┐р░жр░╛: р░кр▒Нр░░р░др░┐ р░╕р░нр▒Нр░пр▒Бр░бр░┐ р░ир▒Жр░▓р░╡р░╛р░░р▒А р░╡р░╛р░пр░┐р░жр░╛ р░ир▒Бр░Вр░бр░┐ р░бр░┐р░╡р░┐р░бр▒Жр░Вр░бр▒Н р░др░Чр▒Нр░Чр░┐р░Вр░Ър░мр░бр▒Бр░др▒Бр░Вр░жр░┐.",
                monthly_rate: "р░ир▒Жр░▓р░╡р░╛р░░р▒А %",
                total_percentage: "р░ор▒Кр░др▒Нр░др░В р░╢р░╛р░др░В",
                annual_rate: "р░╡р░╛р░░р▒Нр░╖р░┐р░Х р░░р▒Зр░Яр▒Б",
                total: "р░ор▒Кр░др▒Нр░др░В"
            },
            hi: {
                title: "рдПрдбрд╡рд╛рдВрд╕реНрдб рдЪрд┐рдЯ рдлрдВрдб рдХреИрд▓рдХреБрд▓реЗрдЯрд░",
                subtitle: "рдмрд┐рдбрд┐рдВрдЧ рд░реЗрдЯреНрд╕, рдореБрдирд╛рдлреЗ рдХреА рдЧрдгрдирд╛ рдХрд░реЗрдВ рдФрд░ рдмрд┐рдб рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╕рдмрд╕реЗ рдЕрдЪреНрдЫрд╛ рдорд╣реАрдирд╛ рдЦреЛрдЬреЗрдВ",
                calculator: "рдХреИрд▓рдХреБрд▓реЗрдЯрд░",
                analysis_report: "рд╡рд┐рд╢реНрд▓реЗрд╖рдг рд░рд┐рдкреЛрд░реНрдЯ",
                best_month_analysis: "рд╕рд░реНрд╡реЛрддреНрддрдо рдорд╣реАрдирд╛ рд╡рд┐рд╢реНрд▓реЗрд╖рдг",
                notes: "рдиреЛрдЯреНрд╕",
                analysis: "ЁЯУК рд╡рд┐рд╢реНрд▓реЗрд╖рдг",
                comparison: "ЁЯПЖ рд╕рд░реНрд╡реЛрддреНрддрдо рдорд╣реАрдирд╛",
                chit_details: "рдЪрд┐рдЯ рдлрдВрдб рд╡рд┐рд╡рд░рдг",
                chit_amount: "рдЪрд┐рдЯ рд░рд╛рд╢рд┐ (тВ╣)",
                total_months: "рдХреБрд▓ рдорд╣реАрдиреЗ",
                commission: "рдХрдореАрд╢рди (%)",
                monthly_installment: "рдорд╛рд╕рд┐рдХ рдХрд┐рд╕реНрдд (тВ╣)",
                bidding_details: "рдмрд┐рдбрд┐рдВрдЧ рд╡рд┐рд╡рд░рдг",
                current_month: "рд╡рд░реНрддрдорд╛рди рдорд╣реАрдирд╛",
                bid_amount: "рдмрд┐рдб рд░рд╛рд╢рд┐",
                bid_rate: "рдмрд┐рдб рд░реЗрдЯ",
                calculate: "рдЧрдгрдирд╛ рдХрд░реЗрдВ",
                results: "рдкрд░рд┐рдгрд╛рдо",
                bidding_rate: "рдмрд┐рдбрд┐рдВрдЧ рд░реЗрдЯ",
                amount_received: "рдмрд┐рдбрд░ рдХреЛ рдкреНрд░рд╛рдкреНрдд рд░рд╛рд╢рд┐",
                dividend_per_member: "рдкреНрд░рддрд┐ рд╕рджрд╕реНрдп рдбрд┐рд╡рд┐рдбреЗрдВрдб",
                net_installment: "рдиреЗрдЯ рдХрд┐рд╕реНрдд",
                savings_percentage: "рдорд╛рд╕рд┐рдХ рдмрдЪрдд",
                organizer_commission: "рдЖрдпреЛрдЬрдХ рдХрдореАрд╢рди",
                share: "рдкрд░рд┐рдгрд╛рдо рд╕рд╛рдЭрд╛ рдХрд░реЗрдВ",
                save: "рд╕реЗрд╡ рдХрд░реЗрдВ",
                monthly_analysis: "рдорд╛рд╕рд┐рдХ рд╡рд┐рд╢реНрд▓реЗрд╖рдг рд░рд┐рдкреЛрд░реНрдЯ",
                generate_analysis: "рд╡рд┐рд╢реНрд▓реЗрд╖рдг рдЬреЗрдирд░реЗрдЯ рдХрд░реЗрдВ",
                export_pdf: "PDF рдПрдХреНрд╕рдкреЛрд░реНрдЯ",
                export_csv: "CSV рдПрдХреНрд╕рдкреЛрд░реНрдЯ",
                month: "рдорд╣реАрдирд╛",
                profit_loss: "рд▓рд╛рдн/рд╣рд╛рдирд┐",
                roi: "ROI %",
                click_generate: "рдорд╛рд╕рд┐рдХ рд╡рд┐рд╡рд░рдг рджреЗрдЦрдиреЗ рдХреЗ рд▓рд┐рдП \"рд╡рд┐рд╢реНрд▓реЗрд╖рдг рдЬреЗрдирд░реЗрдЯ рдХрд░реЗрдВ\" рдкрд░ рдХреНрд▓рд┐рдХ рдХрд░реЗрдВ",
                best_month_analysis: "рд╕рд░реНрд╡реЛрддреНрддрдо рдорд╣реАрдирд╛ рд╡рд┐рд╢реНрд▓реЗрд╖рдг",
                external_interest: "рдмрд╛рд╣рд░реА рдмреНрдпрд╛рдЬ рджрд░ (%)",
                analyze: "рд╡рд┐рд╢реНрд▓реЗрд╖рдг рдХрд░реЗрдВ",
                recommended_month: "ЁЯПЖ рдЕрдиреБрд╢рдВрд╕рд┐рдд рдорд╣реАрдирд╛:",
                max_benefit: "рдЕрдзрд┐рдХрддрдо рд▓рд╛рдн:",
                chit_benefit: "рдЪрд┐рдЯ рд▓рд╛рдн",
                external_benefit: "рдмрд╛рд╣рд░реА рд▓рд╛рдн",
                total_benefit: "рдХреБрд▓ рд▓рд╛рдн",
                rank: "рд░реИрдВрдХ",
                click_analyze: "рд╕рдмрд╕реЗ рдЕрдЪреНрдЫрд╛ рдорд╣реАрдирд╛ рдЦреЛрдЬрдиреЗ рдХреЗ рд▓рд┐рдП \"рд╡рд┐рд╢реНрд▓реЗрд╖рдг рдХрд░реЗрдВ\" рдкрд░ рдХреНрд▓рд┐рдХ рдХрд░реЗрдВ",
                notes_title: "рдЪрд┐рдЯ рдлрдВрдб рд╡рд┐рд╡рд░рдг",
                chit_details_header: "рдЪрд┐рдЯ рдлрдВрдб рд╡рд┐рд╡рд░рдг",
                chit_amount_desc: "рдЪрд┐рдЯ рд░рд╛рд╢рд┐ (рдХреБрд▓ рдореВрд▓реНрдп): тВ╣40,00,000",
                total_months_desc: "рдХреБрд▓ рдорд╣реАрдиреЗ: 20",
                commission_desc: "рдЖрдпреЛрдЬрдХ рдХрдореАрд╢рди: тВ╣1,60,000 (рдЬреЛ рдХреБрд▓ рдЪрд┐рдЯ рд░рд╛рд╢рд┐ рдХрд╛ 4% рд╣реИ)",
                installment_desc: "рдорд╛рд╕рд┐рдХ рдХрд┐рд╕реНрдд: рдкреНрд░рддрд┐ рд╕рджрд╕реНрдп тВ╣2,00,000.",
                bidding_results_header: "рдмрд┐рдбрд┐рдВрдЧ рдФрд░ рдкрд░рд┐рдгрд╛рдо",
                bidding_explanation: "рдпрд╣рд╛рдБ рдиреАрд▓рд╛рдореА рдФрд░ рдЗрд╕рдХреЗ рдкрд░рд┐рдгрд╛рдореЛрдВ рдХреА рдЪрд░рдгрдмрджреНрдз рд╡реНрдпрд╛рдЦреНрдпрд╛ рд╣реИ:",
                amount_received_desc: "рдмрд┐рдбрд░ рджреНрд╡рд╛рд░рд╛ рдкреНрд░рд╛рдкреНрдд рд░рд╛рд╢рд┐: рдЬреАрддрдиреЗ рд╡рд╛рд▓реЗ рдмрд┐рдбрд░ рдХреЛ тВ╣27,30,000 рдорд┐рд▓реЗ.",
                bid_amount_desc: "рдмрд┐рдб рд░рд╛рд╢рд┐: рдпрд╣ рд░рд╛рд╢рд┐ рдкрд╛рдиреЗ рдХреЗ рд▓рд┐рдП, рдЬреАрддрдиреЗ рд╡рд╛рд▓реЗ рдиреЗ рдПрдХ рдЫреВрдЯ (рдмрд┐рдб) рдХреЗ рд▓рд┐рдП рд╕рд╣рдорддрд┐ рджреА. рдпрд╣ рдмрд┐рдб рд░рд╛рд╢рд┐ рдХреБрд▓ рдЪрд┐рдЯ рдореВрд▓реНрдп рд╕реЗ рдкреНрд░рд╛рдкреНрдд рд░рд╛рд╢рд┐ рдШрдЯрд╛рдХрд░ рдЧрдгрдирд╛ рдХреА рдЬрд╛рддреА рд╣реИ.",
                bid_rate_desc: "рдмрд┐рдб рджрд░: рдпрд╣ рдмрд┐рдб рд░рд╛рд╢рд┐ рдХреБрд▓ рдЪрд┐рдЯ рд░рд╛рд╢рд┐ рдкрд░ 31.75% рдЫреВрдЯ рджрд░реНрд╢рд╛рддреА рд╣реИ.",
                dividend_desc: "рдкреНрд░рддрд┐ рд╕рджрд╕реНрдп рдбрд┐рд╡рд┐рдбреЗрдВрдб: рдбрд┐рд╡рд┐рдбреЗрдВрдб рдХреЗ рд▓рд┐рдП рдЙрдкрд▓рдмреНрдз рдХреБрд▓ рд░рд╛рд╢рд┐ рдмрд┐рдб рд░рд╛рд╢рд┐ рдорд╛рдЗрдирд╕ рдЖрдпреЛрдЬрдХ рдХрд╛ рдХрдореАрд╢рди рд╣реИ. рдпрд╣ рд░рд╛рд╢рд┐ рд╕рднреА 20 рд╕рджрд╕реНрдпреЛрдВ рдореЗрдВ рд╕рдорд╛рди рд░реВрдк рд╕реЗ рдмрд╛рдБрдЯреА рдЬрд╛рддреА рд╣реИ.",
                net_installment_desc: "рдиреЗрдЯ рдХрд┐рд╕реНрдд: рд╣рд░ рд╕рджрд╕реНрдп рдХреА рдорд╛рд╕рд┐рдХ рдХрд┐рд╕реНрдд рдореЗрдВ рд╕реЗ рдбрд┐рд╡рд┐рдбреЗрдВрдб рдХрд╛рдЯ рджрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ.",
                monthly_analysis: "рдорд╛рд╕рд┐рдХ рд╡рд┐рд╢реНрд▓реЗрд╖рдг рд░рд┐рдкреЛрд░реНрдЯ",
                organizer_commission: "рдЖрдпреЛрдЬрдХ рдХрдореАрд╢рди",
                profit_loss: "рд▓рд╛рдн/рд╣рд╛рдирд┐",
                monthly_rate: "рдорд╛рд╕рд┐рдХ %",
                total_percentage: "рдХреБрд▓ рдкреНрд░рддрд┐рд╢рдд",
                annual_rate: "рд╡рд╛рд░реНрд╖рд┐рдХ рджрд░",
                total: "рдХреБрд▓"
            },
            ta: {
                title: "роЪро┐роЯрпН роГрокрогрпНроЯрпН роХро╛ро▓рпНроХрпБро▓рпЗроЯрпНроЯро░рпН",
                calculator: "роХро╛ро▓рпНроХрпБро▓рпЗроЯрпНроЯро░рпН",
                analysis_report: "рокроХрпБрокрпНрокро╛ропрпНро╡рпБ роЕро▒ро┐роХрпНроХрпИ",
                best_month_analysis: "роЪро┐ро▒роирпНрод рооро╛род рокроХрпБрокрпНрокро╛ропрпНро╡рпБ",
                notes: "роХрпБро▒ро┐рокрпНрокрпБроХро│рпН",
                analysis: "ЁЯУК рокроХрпБрокрпНрокро╛ропрпНро╡рпБ",
                comparison: "ЁЯПЖ роЪро┐ро▒роирпНрод рооро╛родроорпН",
                monthly_analysis: "рооро╛родро╛роирпНрод рокроХрпБрокрпНрокро╛ропрпНро╡рпБ роЕро▒ро┐роХрпНроХрпИ",
                chit_amount: "роЪро┐роЯрпН родрпКроХрпИ (тВ╣)",
                commission: "роХрооро┐ро╖ройрпН (%)",
                total_months: "роорпБро┤рпБ рооро╛родроЩрпНроХро│рпН",
                current_month: "родро▒рпНрокрпЛродрпИроп рооро╛родроорпН",
                monthly_installment: "рооро╛родро╛роирпНрод родрпЖро╛роХрпИ (тВ╣)",
                bid_amount: "рокро┐роЯрпН родрпКроХрпИ",
                net_installment: "роирпЖроЯрпН родрпЖро╛роХрпИ",
                month: "рооро╛родроорпН",
                organizer_commission: "роЖропрпЛроЬроХро░рпН роХрооро┐ро╖ройрпН",
                amount_received: "рокро┐роЯрпНроЯро░рпН рокрпЖро▒рпНро▒ родрпКроХрпИ",
                profit_loss: "ро▓ро╛рокроорпН/роироЯрпНроЯроорпН",
                monthly_rate: "рооро╛родро╛роирпНрод %",
                total_percentage: "роорпБро┤рпБ роЪродро╡рпАродроорпН",
                annual_rate: "ро╡ро░рпБроЯро╛роирпНрод ро╡ро┐ро▓рпИ",
                total: "роорпБро┤рпБ"
            },
            kn: {
                title: "р▓Ър▓┐р▓Яр│Н р▓лр▓Вр▓бр│Н р▓Хр│Нр▓пр▓╛р▓▓р│Нр▓Хр│Бр▓▓р│Зр▓Яр▓░р│Н",
                calculator: "р▓Хр│Нр▓пр▓╛р▓▓р│Нр▓Хр│Бр▓▓р│Зр▓Яр▓░р│Н",
                analysis_report: "р▓╡р▓┐р▓╢р│Нр▓▓р│Зр▓╖р▓гр│Ж р▓╡р▓░р▓жр▓┐",
                best_month_analysis: "р▓Ер▓др│Нр▓пр│Бр▓др│Нр▓др▓о р▓др▓┐р▓Вр▓Чр▓│ р▓╡р▓┐р▓╢р│Нр▓▓р│Зр▓╖р▓гр│Ж",
                notes: "р▓Яр▓┐р▓кр│Нр▓кр▓гр▓┐р▓Чр▓│р│Б",
                analysis: "ЁЯУК р▓╡р▓┐р▓╢р│Нр▓▓р│Зр▓╖р▓гр│Ж",
                comparison: "ЁЯПЖ р▓Ер▓др│Нр▓пр│Бр▓др│Нр▓др▓о р▓др▓┐р▓Вр▓Чр▓│р│Б",
                monthly_analysis: "р▓ор▓╛р▓╕р▓┐р▓Х р▓╡р▓┐р▓╢р│Нр▓▓р│Зр▓╖р▓гр│Ж р▓╡р▓░р▓жр▓┐",
                chit_amount: "р▓Ър▓┐р▓Яр│Н р▓░р▓╛р▓╢р▓┐ (тВ╣)",
                commission: "р▓Хр▓ор▓┐р▓╖р▓ир│Н (%)",
                total_months: "р▓Тр▓Яр│Нр▓Яр│Б р▓др▓┐р▓Вр▓Чр▓│р│Б",
                current_month: "р▓Ир▓Чр▓┐р▓и р▓др▓┐р▓Вр▓Чр▓│р│Б",
                monthly_installment: "р▓ор▓╛р▓╕р▓┐р▓Х р▓╡р│Зр▓др▓и (тВ╣)",
                bid_amount: "р▓мр▓┐р▓бр│Н р▓░р▓╛р▓╢р▓┐",
                net_installment: "р▓ир│Жр▓Яр│Н р▓╡р│Зр▓др▓и",
                month: "р▓др▓┐р▓Вр▓Чр▓│р│Б",
                organizer_commission: "р▓Жр▓пр│Лр▓Ьр▓Х р▓Хр▓ор▓┐р▓╖р▓ир│Н",
                amount_received: "р▓мр▓┐р▓бр│Нр▓жр▓░р│Н р▓кр▓бр│Жр▓ж р▓░р▓╛р▓╢р▓┐",
                profit_loss: "р▓▓р▓╛р▓н/р▓ир▓╖р│Нр▓Я",
                monthly_rate: "р▓ор▓╛р▓╕р▓┐р▓Х %",
                total_percentage: "р▓Тр▓Яр│Нр▓Яр│Б р▓╢р▓др▓ор▓╛р▓и",
                annual_rate: "р▓╡р▓╛р▓░р│Нр▓╖р▓┐р▓Х р▓жр▓░",
                total: "р▓Тр▓Яр│Нр▓Яр│Б"
            },
            ml: {
                title: "р┤Ър┤┐р┤▒р╡Нр┤▒р╡Н р┤лр┤гр╡Нр┤Яр╡Н р┤Хр┤╛р╡╜р┤Хр╡Нр┤Хр╡Бр┤▓р╡Зр┤▒р╡Нр┤▒р╡╝",
                calculator: "р┤Хр┤╛р╡╜р┤Хр╡Нр┤Хр╡Бр┤▓р╡Зр┤▒р╡Нр┤▒р╡╝",
                analysis_report: "р┤╡р┤┐р┤╢р┤Хр┤▓р┤и р┤▒р┤┐р┤кр╡Нр┤кр╡Лр╡╝р┤Яр╡Нр┤Яр╡Н",
                best_month_analysis: "р┤ор┤┐р┤Хр┤Ър╡Нр┤Ъ р┤ор┤╛р┤╕ р┤╡р┤┐р┤╢р┤Хр┤▓р┤ир┤В",
                notes: "р┤Хр╡Бр┤▒р┤┐р┤кр╡Нр┤кр╡Бр┤Хр╡╛",
                analysis: "ЁЯУК р┤╡р┤┐р┤╢р┤Хр┤▓р┤ир┤В",
                comparison: "ЁЯПЖ р┤ор┤┐р┤Хр┤Ър╡Нр┤Ъ р┤ор┤╛р┤╕р┤В",
                monthly_analysis: "р┤ор┤╛р┤╕р┤┐р┤Х р┤╡р┤┐р┤╢р┤Хр┤▓р┤и р┤▒р┤┐р┤кр╡Нр┤кр╡Лр╡╝р┤Яр╡Нр┤Яр╡Н",
                chit_amount: "р┤Ър┤┐р┤▒р╡Нр┤▒р╡Н р┤др╡Бр┤Х (тВ╣)",
                commission: "р┤Хр┤ор╡Ар┤╖р╡╗ (%)",
                total_months: "р┤ор╡Кр┤др╡Нр┤др┤В р┤ор┤╛р┤╕р┤Щр╡Нр┤Щр╡╛",
                current_month: "р┤ир┤┐р┤▓р┤╡р┤┐р┤▓р╡Ж р┤ор┤╛р┤╕р┤В",
                monthly_installment: "р┤ор┤╛р┤╕р┤┐р┤Х р┤Хр┤┐р┤╕р╡Нр┤др┤┐ (тВ╣)",
                bid_amount: "р┤мр┤┐р┤бр╡Н р┤др╡Бр┤Х",
                net_installment: "р┤ир╡Жр┤▒р╡Нр┤▒р╡Н р┤Хр┤┐р┤╕р╡Нр┤др┤┐",
                month: "р┤ор┤╛р┤╕р┤В",
                organizer_commission: "р┤Жр┤пр╡Лр┤Ьр┤Хр╡╗ р┤Хр┤ор╡Ар┤╖р╡╗",
                amount_received: "р┤мр┤┐р┤бр╡Нр┤бр╡╝р┤Хр╡Нр┤Хр╡Н р┤▓р┤нр┤┐р┤Ър╡Нр┤Ъ р┤др╡Бр┤Х",
                profit_loss: "р┤▓р┤╛р┤нр┤В/р┤ир┤╖р╡Нр┤Яр┤В",
                monthly_rate: "р┤ор┤╛р┤╕р┤┐р┤Х %",
                total_percentage: "р┤ор╡Кр┤др╡Нр┤др┤В р┤╢р┤др┤ор┤╛р┤ир┤В",
                annual_rate: "р┤╡р┤╛р╡╝р┤╖р┤┐р┤Х р┤жр┤░р┤В",
                total: "р┤ор╡Кр┤др╡Нр┤др┤В"
            },
            gu: {
                title: "ркЪрк┐ркЯ рклркВркб ркХрлЗрк▓рлНркХрлНркпрлБрк▓рлЗркЯрк░",
                calculator: "ркХрлЗрк▓рлНркХрлНркпрлБрк▓рлЗркЯрк░",
                analysis_report: "рк╡рк┐рк╢рлНрк▓рлЗрк╖ркг рк░рк┐рккрлЛрк░рлНркЯ",
                best_month_analysis: "рк╢рлНрк░рлЗрк╖рлНрка ркорк╣рк┐ркирлЛ рк╡рк┐рк╢рлНрк▓рлЗрк╖ркг",
                notes: "ркирлЛркВркзрлЛ",
                analysis: "ЁЯУК рк╡рк┐рк╢рлНрк▓рлЗрк╖ркг",
                comparison: "ЁЯПЖ рк╢рлНрк░рлЗрк╖рлНрка ркорк╣рк┐ркирлЛ",
                monthly_analysis: "ркорк╛рк╕рк┐ркХ рк╡рк┐рк╢рлНрк▓рлЗрк╖ркг рк░рк┐рккрлЛрк░рлНркЯ",
                chit_amount: "ркЪрк┐ркЯ рк░ркХрко (тВ╣)",
                commission: "ркХркорк┐рк╢рки (%)",
                total_months: "ркХрлБрк▓ ркорк╣рк┐ркирк╛ркУ",
                current_month: "рк╡рк░рлНркдркорк╛рки ркорк╣рк┐ркирлЛ",
                monthly_installment: "ркорк╛рк╕рк┐ркХ рк╣рккрлНркдрлЛ (тВ╣)",
                bid_amount: "ркмрк┐ркб рк░ркХрко",
                net_installment: "ркирлЗркЯ рк╣рккрлНркдрлЛ",
                month: "ркорк╣рк┐ркирлЛ",
                organizer_commission: "ркЖркпрлЛркЬркХ ркХркорк┐рк╢рки",
                amount_received: "ркмрк┐ркбрк░ркирлЗ ркорк│рлЗрк▓ рк░ркХрко",
                profit_loss: "рклрк╛ркпркжрлЛ/ркирлЛркХрк╕рк╛рки",
                monthly_rate: "ркорк╛рк╕рк┐ркХ %",
                total_percentage: "ркХрлБрк▓ ркЯркХрк╛рк╡рк╛рк░рлА",
                annual_rate: "рк╡рк╛рк░рлНрк╖рк┐ркХ ркжрк░",
                total: "ркХрлБрк▓"
            },
            mr: {
                title: "рдЪрд┐рдЯ рдлрдВрдб рдХреЕрд▓реНрдХреНрдпреБрд▓реЗрдЯрд░",
                calculator: "рдХреЕрд▓реНрдХреНрдпреБрд▓реЗрдЯрд░",
                analysis_report: "рд╡рд┐рд╢реНрд▓реЗрд╖рдг рдЕрд╣рд╡рд╛рд▓",
                best_month_analysis: "рд╕рд░реНрд╡реЛрддреНрддрдо рдорд╣рд┐рдирд╛ рд╡рд┐рд╢реНрд▓реЗрд╖рдг",
                notes: "рдЯрд┐рдкрд╛",
                analysis: "ЁЯУК рд╡рд┐рд╢реНрд▓реЗрд╖рдг",
                comparison: "ЁЯПЖ рд╕рд░реНрд╡реЛрддреНрддрдо рдорд╣рд┐рдирд╛",
                monthly_analysis: "рдорд╛рд╕рд┐рдХ рд╡рд┐рд╢реНрд▓реЗрд╖рдг рдЕрд╣рд╡рд╛рд▓",
                chit_amount: "рдЪрд┐рдЯ рд░рдХрдо (тВ╣)",
                commission: "рдХрдорд┐рд╢рди (%)",
                total_months: "рдПрдХреВрдг рдорд╣рд┐рдиреЗ",
                current_month: "рд╕рджреНрдпрд╛рдЪрд╛ рдорд╣рд┐рдирд╛",
                monthly_installment: "рдорд╛рд╕рд┐рдХ рд╣рдкреНрддрд╛ (тВ╣)",
                bid_amount: "рдмрд┐рдб рд░рдХрдо",
                net_installment: "рдиреЗрдЯ рд╣рдкреНрддрд╛",
                month: "рдорд╣рд┐рдирд╛",
                organizer_commission: "рдЖрдпреЛрдЬрдХ рдХрдорд┐рд╢рди",
                amount_received: "рдмрд┐рдбрд░рд▓рд╛ рдорд┐рд│рд╛рд▓реЗрд▓реА рд░рдХрдо",
                profit_loss: "рдирдлрд╛/рддреЛрдЯрд╛",
                monthly_rate: "рдорд╛рд╕рд┐рдХ %",
                total_percentage: "рдПрдХреВрдг рдЯрдХреНрдХреЗрд╡рд╛рд░реА",
                annual_rate: "рд╡рд╛рд░реНрд╖рд┐рдХ рджрд░",
                total: "рдПрдХреВрдг"
            },
            bn: {
                title: "ржЪрж┐ржЯ ржлрж╛ржирзНржб ржХрзНржпрж╛рж▓ржХрзБрж▓рзЗржЯрж░",
                calculator: "ржХрзНржпрж╛рж▓ржХрзБрж▓рзЗржЯрж░",
                analysis_report: "ржмрж┐рж╢рзНрж▓рзЗрж╖ржг ржкрзНрж░рждрж┐ржмрзЗржжржи",
                best_month_analysis: "рж╕рзЗрж░рж╛ ржорж╛рж╕ ржмрж┐рж╢рзНрж▓рзЗрж╖ржг",
                notes: "ржирзЛржЯ",
                analysis: "ЁЯУК ржмрж┐рж╢рзНрж▓рзЗрж╖ржг",
                comparison: "ЁЯПЖ рж╕рзЗрж░рж╛ ржорж╛рж╕"
            },
            pa: {
                title: "риЪри┐рй▒риЯ рилрй░риб риХрйИри▓риХрйБри▓рйЗриЯри░",
                calculator: "риХрйИри▓риХрйБри▓рйЗриЯри░",
                analysis_report: "ри╡ри┐ри╕ри╝ри▓рйЗри╕ри╝риг ри░ри┐рикрйЛри░риЯ",
                best_month_analysis: "ри╕рин ридрйЛриВ ри╡ризрйАриЖ риори╣рйАриири╛ ри╡ри┐ри╕ри╝ри▓рйЗри╕ри╝риг",
                notes: "риирйЛриЯри╕",
                analysis: "ЁЯУК ри╡ри┐ри╕ри╝ри▓рйЗри╕ри╝риг",
                comparison: "ЁЯПЖ ри╕рин ридрйЛриВ ри╡ризрйАриЖ риори╣рйАриири╛"
            },
            or: {
                title: "рмЪрм┐рмЯрнН рмлрмгрнНрмб рмХрнНрнЯрм╛рм▓рмХрнБрм▓рнЗрмЯрм░",
                calculator: "рмХрнНрнЯрм╛рм▓рмХрнБрм▓рнЗрмЯрм░",
                analysis_report: "рммрм┐рм╢рнНрм│рнЗрм╖рмг рм░рм┐рмкрнЛрм░рнНрмЯ",
                best_month_analysis: "рм╕рм░рнНрммрнЛрмдрнНрмдрмо рморм╛рм╕ рммрм┐рм╢рнНрм│рнЗрм╖рмг",
                notes: "рмирнЛрмЯрнНрм╕",
                analysis: "ЁЯУК рммрм┐рм╢рнНрм│рнЗрм╖рмг",
                comparison: "ЁЯПЖ рм╕рм░рнНрммрнЛрмдрнНрмдрмо рморм╛рм╕"
            },
            as: {
                title: "ржЪрж┐ржЯ ржлрж╛ржгрзНржб ржХрзЗрж▓ржХрзБрж▓рзЗржЯрз░",
                calculator: "ржХрзЗрж▓ржХрзБрж▓рзЗржЯрз░",
                analysis_report: "ржмрж┐рж╢рзНрж▓рзЗрж╖ржг ржкрзНрз░рждрж┐ржмрзЗржжржи",
                best_month_analysis: "рж╕рз░рзНржмрзЛрждрзНрждржо ржорж╛рж╣ ржмрж┐рж╢рзНрж▓рзЗрж╖ржг",
                notes: "ржЯрзЛржХрж╛",
                analysis: "ЁЯУК ржмрж┐рж╢рзНрж▓рзЗрж╖ржг",
                comparison: "ЁЯПЖ рж╕рз░рзНржмрзЛрждрзНрждржо ржорж╛рж╣"
            }
        };

        let currentLanguage = 'en';
        let analysisData = [];

        function changeLanguage() {
            currentLanguage = document.getElementById('languageSelector').value;
            updateTexts();
        }

        function updateTexts() {
            document.querySelectorAll('[data-translate]').forEach(element => {
                const key = element.getAttribute('data-translate');
                if (translations[currentLanguage][key]) {
                    element.textContent = translations[currentLanguage][key];
                }
            });
        }

        function showTab(tabName) {
            document.querySelectorAll('.tab-btn').forEach(tab => tab.classList.remove('active'));
            document.querySelectorAll('.tab-content').forEach(content => content.classList.remove('active'));
            
            // Find and activate the correct tab button
            const tabButtons = document.querySelectorAll('.tab-btn');
            if (tabName === 'calculator') tabButtons[0].classList.add('active');
            else if (tabName === 'analysis') tabButtons[1].classList.add('active');
            else if (tabName === 'comparison') tabButtons[2].classList.add('active');
            
            document.getElementById(tabName).classList.add('active');
            
            // Auto-generate comparison when Best Month tab is opened
            if (tabName === 'comparison') {
                generateComparison();
            }
        }

        function formatInput(input) {
            const value = parseFloat(input.value.replace(/,/g, '')) || 0;
            input.value = new Intl.NumberFormat('en-IN').format(value);
        }

        function removeCommas(input) {
            input.value = input.value.replace(/,/g, '');
        }

        function toggleBidType() {
            const bidType = document.querySelector('input[name="bidType"]:checked').value;
            document.getElementById('bidAmountGroup').style.display = bidType === 'amount' ? 'block' : 'none';
            document.getElementById('bidRateGroup').style.display = bidType === 'rate' ? 'block' : 'none';
        }

        function calculate() {
            const chitAmount = parseFloat(document.getElementById('chitAmount').value.replace(/,/g, '')) || 0;
            const totalMonths = parseInt(document.getElementById('totalMonths').value) || 20;
            const commission = parseFloat(document.getElementById('commission').value) || 4;
            const monthlyInstallment = parseFloat(document.getElementById('monthlyInstallment').value.replace(/,/g, '')) || 0;
            const currentMonth = parseInt(document.getElementById('currentMonth').value) || 1;
            const bidType = document.querySelector('input[name="bidType"]:checked').value;

            let bidAmount, bidRate;

            if (bidType === 'amount') {
                bidAmount = parseFloat(document.getElementById('bidAmount').value.replace(/,/g, '')) || 0;
                const remainingMonths = totalMonths - currentMonth + 1;
                bidRate = (bidAmount * 12 * 100) / ((chitAmount - bidAmount) * remainingMonths);
            } else {
                bidRate = parseFloat(document.getElementById('bidRate').value) || 0;
                bidAmount = (bidRate * chitAmount * (totalMonths - currentMonth + 1)) / 
                           (12 * 100 + bidRate * (totalMonths - currentMonth + 1));
            }

            const organizerCommission = (commission * chitAmount) / 100;
            const amountReceived = chitAmount - bidAmount;
            const totalDividend = bidAmount - organizerCommission;
            const dividendPerMember = totalDividend / totalMonths;
            const calculatedNet = monthlyInstallment - dividendPerMember;
            const netInstallment = Math.max(0, Math.min(calculatedNet, monthlyInstallment));
            const savingsPercentage = (dividendPerMember / monthlyInstallment) * 100;

            // Update display
            document.getElementById('biddingRate').textContent = bidRate.toFixed(2) + '%';
            document.getElementById('amountReceived').textContent = 'тВ╣' + new Intl.NumberFormat('en-IN').format(amountReceived);
            document.getElementById('dividendPerMember').textContent = 'тВ╣' + new Intl.NumberFormat('en-IN').format(dividendPerMember);
            document.getElementById('netInstallment').textContent = 'тВ╣' + new Intl.NumberFormat('en-IN').format(netInstallment);
            document.getElementById('savingsPercentage').textContent = savingsPercentage.toFixed(2) + '%';
            document.getElementById('organizerCommission').textContent = 'тВ╣' + new Intl.NumberFormat('en-IN').format(organizerCommission);

            // Update sliders
            document.getElementById('bidAmountSlider').value = bidAmount;
            document.getElementById('bidRateSlider').value = bidRate;
        }

        let editMode = false;
        let detailedAnalysisData = [
            [1, 1270000, 160000, 144500, 2730000, -665000, -1.22, -24.36, -14.62],
            [2, 1320000, 160000, 142000, 2680000, -715000, -1.33, -26.68, -16.01],
            [3, 1295000, 160000, 143250, 2705000, -690000, -1.28, -25.51, -15.30],
            [4, 1290000, 160000, 143500, 2710000, -685000, -1.26, -25.28, -15.17],
            [5, 1220000, 160000, 147000, 2780000, -615000, -1.11, -22.12, -13.27],
            [6, 1150000, 160000, 150500, 2850000, -545000, -0.96, -19.12, -11.47],
            [7, 1020000, 160000, 157000, 2980000, -415000, -0.70, -13.93, -8.36],
            [8, 910000, 160000, 162500, 3090000, -305000, -0.49, -9.87, -5.92],
            [9, 800000, 160000, 168000, 3200000, -195000, -0.30, -6.09, -3.66],
            [10, 755000, 160000, 170250, 3245000, -150000, -0.23, -4.62, -2.77],
            [11, 730000, 160000, 171500, 3270000, -125000, -0.19, -3.82, -2.29],
            [12, 685000, 160000, 173750, 3315000, -80000, -0.12, -2.41, -1.45],
            [13, 585000, 160000, 178750, 3415000, 20000, 0.03, 0.59, 0.35],
            [14, 505000, 160000, 182750, 3495000, 100000, 0.14, 2.86, 1.72],
            [15, 445000, 160000, 185750, 3555000, 160000, 0.23, 4.50, 2.70],
            [16, 380000, 160000, 189000, 3620000, 225000, 0.31, 6.22, 3.73],
            [17, 320000, 160000, 192000, 3680000, 285000, 0.39, 7.74, 4.65],
            [18, 260000, 160000, 195000, 3740000, 345000, 0.46, 9.22, 5.53],
            [19, 200000, 160000, 198000, 3800000, 405000, 0.53, 10.66, 6.39],
            [20, 0, 160000, 200000, 3840000, 445000, 0.58, 11.59, 6.95]
        ];

        function submitValues() {
            // Auto-populate from calculator tab if analysis fields are empty or default
            if (document.getElementById('analysisChitAmount').value === '40,00,000' || !document.getElementById('analysisChitAmount').value) {
                document.getElementById('analysisChitAmount').value = document.getElementById('chitAmount').value;
            }
            if (document.getElementById('analysisCommission').value === '4.00' || !document.getElementById('analysisCommission').value) {
                document.getElementById('analysisCommission').value = document.getElementById('commission').value;
            }
            if (document.getElementById('analysisTotalMonths').value === '20' || !document.getElementById('analysisTotalMonths').value) {
                document.getElementById('analysisTotalMonths').value = document.getElementById('totalMonths').value;
            }
            if (document.getElementById('analysisCurrentMonth').value === '1' || !document.getElementById('analysisCurrentMonth').value) {
                document.getElementById('analysisCurrentMonth').value = document.getElementById('currentMonth').value;
            }
            if (document.getElementById('analysisAuctionAmount').value === '2,00,000' || !document.getElementById('analysisAuctionAmount').value) {
                document.getElementById('analysisAuctionAmount').value = document.getElementById('monthlyInstallment').value;
            }
            if (document.getElementById('analysisBidAmount').value === '12,70,000' || !document.getElementById('analysisBidAmount').value) {
                document.getElementById('analysisBidAmount').value = document.getElementById('bidAmount').value;
            }
            
            const chitAmount = parseFloat(document.getElementById('analysisChitAmount').value.replace(/,/g, '')) || 4000000;
            const commission = parseFloat(document.getElementById('analysisCommission').value) || 4;
            const auctionAmount = parseFloat(document.getElementById('analysisAuctionAmount').value.replace(/,/g, '')) || 200000;
            const bidAmount = parseFloat(document.getElementById('analysisBidAmount').value.replace(/,/g, '')) || 1270000;
            const totalMonths = parseInt(document.getElementById('analysisTotalMonths').value) || 20;
            
            // Update header with dynamic total months
            document.getElementById('totalMonthsHeader').textContent = totalMonths;
            
            const dealerCommission = (commission * chitAmount) / 100;
            
            // Update detailedAnalysisData with dynamic commission
            const currentMonthValue = parseInt(document.getElementById('analysisCurrentMonth').value) || 1;
            
            // If no existing data, create empty structure
            if (detailedAnalysisData.length === 0) {
                detailedAnalysisData = [];
                for (let month = 1; month <= totalMonths; month++) {
                    detailedAnalysisData.push([month, 0, 0, 0, 0, 0, 0, 0, 0]);
                }
            }
            
            // Update only the specific current month with the bid amount from calculator
            if (currentMonthValue >= 1 && currentMonthValue <= totalMonths) {
                const monthIndex = currentMonthValue - 1;
                detailedAnalysisData[monthIndex][1] = bidAmount; // Update bid amount for current month only
                detailedAnalysisData[monthIndex][2] = dealerCommission; // Update commission
                
                // Calculate values for this specific month only
                const bidderGets = chitAmount - bidAmount;
                const totalDividend = bidAmount - dealerCommission;
                const dividendPerPerson = totalDividend / totalMonths;
                const calculatedPayable = auctionAmount - dividendPerPerson;
                const payableInstallment = Math.max(0, Math.min(calculatedPayable, auctionAmount));
                
                detailedAnalysisData[monthIndex][3] = payableInstallment;
                detailedAnalysisData[monthIndex][4] = bidderGets;
                
                // Calculate profit/loss using dynamic total payable
                setTimeout(() => {
                    const totalPayableSum = detailedAnalysisData.reduce((sum, r) => sum + r[3], 0);
                    const profitLoss = bidderGets - totalPayableSum;
                    const totalPercentage = bidderGets > 0 ? (profitLoss / bidderGets) * 100 : 0;
                    const monthlyRate = totalPercentage / totalMonths;
                    const annualRate = monthlyRate * 12;
                    
                    detailedAnalysisData[monthIndex][5] = profitLoss;
                    detailedAnalysisData[monthIndex][6] = monthlyRate;
                    detailedAnalysisData[monthIndex][7] = totalPercentage;
                    detailedAnalysisData[monthIndex][8] = annualRate;
                    
                    generateDetailedAnalysis();
                }, 10);
            }
            
            // No need to recalculate all months - only the current month was updated
            

            
            const totalDividend = bidAmount - dealerCommission;
            const dividendPerPerson = totalDividend / totalMonths;
            const emiMonthlyPaid = Math.max(0, (chitAmount - bidAmount) - dividendPerPerson);
            
            document.getElementById('emiMonthlyPaid').textContent = 'тВ╣' + new Intl.NumberFormat('en-IN').format(emiMonthlyPaid);
            
            generateDetailedAnalysis();
        }

        function generateDetailedAnalysis() {
            const tbody = document.getElementById('analysisBody');
            
            tbody.innerHTML = detailedAnalysisData.map((row, index) => `
                <tr>
                    <td>${row[0]}</td>
                    <td class="${editMode ? 'editable' : ''}">${editMode ? `<input class="edit-input" value="${row[1]}" onchange="updateData(${index}, 1, this.value)" style="width: 80px; padding: 2px; text-align: center;">` : 'тВ╣' + new Intl.NumberFormat('en-IN').format(row[1])}</td>
                    <td class="${editMode ? 'editable' : ''}">${editMode ? `<input class="edit-input" value="${row[2]}" onchange="updateData(${index}, 2, this.value)" style="width: 80px; padding: 2px; text-align: center;">` : 'тВ╣' + new Intl.NumberFormat('en-IN').format(row[2])}</td>
                    <td>тВ╣${new Intl.NumberFormat('en-IN').format(row[3])}</td>
                    <td>тВ╣${new Intl.NumberFormat('en-IN').format(row[4])}</td>
                    <td class="${row[5] >= 0 ? 'profit' : 'loss'}">${row[5] >= 0 ? '+' : ''}тВ╣${new Intl.NumberFormat('en-IN').format(row[5])}</td>
                    <td class="${row[6] >= 0 ? 'profit' : 'loss'}">${row[6] >= 0 ? '+' : ''}${row[6].toFixed(2)}%</td>
                    <td class="${row[7] >= 0 ? 'profit' : 'loss'}">${row[7] >= 0 ? '+' : ''}${row[7].toFixed(2)}%</td>
                    <td class="${row[8] >= 0 ? 'profit' : 'loss'}">${row[8] >= 0 ? '+' : ''}${row[8].toFixed(2)}%</td>
                </tr>
            `).join('');
            
            const totalPayable = detailedAnalysisData.reduce((sum, row) => sum + row[3], 0);
            document.getElementById('totalPayable').textContent = 'тВ╣' + new Intl.NumberFormat('en-IN').format(totalPayable);
        }

        function loadSampleData() {
            document.getElementById('analysisChitAmount').value = '40,00,000';
            document.getElementById('analysisCommission').value = '4.00';
            document.getElementById('analysisTotalMonths').value = '20';
            document.getElementById('analysisCurrentMonth').value = '1';
            document.getElementById('analysisAuctionAmount').value = '2,00,000';
            document.getElementById('analysisBidAmount').value = '12,70,000';
            
            // Create sample data
            detailedAnalysisData = [
                [1, 1270000, 160000, 144500, 2730000, -665000, -1.22, -24.36, -14.62],
                [2, 1320000, 160000, 142000, 2680000, -715000, -1.33, -26.68, -16.01],
                [3, 1295000, 160000, 143250, 2705000, -690000, -1.28, -25.51, -15.30],
                [4, 1290000, 160000, 143500, 2710000, -685000, -1.26, -25.28, -15.17],
                [5, 1220000, 160000, 147000, 2780000, -615000, -1.11, -22.12, -13.27],
                [6, 1150000, 160000, 150500, 2850000, -545000, -0.96, -19.12, -11.47],
                [7, 1020000, 160000, 157000, 2980000, -415000, -0.70, -13.93, -8.36],
                [8, 910000, 160000, 162500, 3090000, -305000, -0.49, -9.87, -5.92],
                [9, 800000, 160000, 168000, 3200000, -195000, -0.30, -6.09, -3.66],
                [10, 755000, 160000, 170250, 3245000, -150000, -0.23, -4.62, -2.77],
                [11, 730000, 160000, 171500, 3270000, -125000, -0.19, -3.82, -2.29],
                [12, 685000, 160000, 173750, 3315000, -80000, -0.12, -2.41, -1.45],
                [13, 585000, 160000, 178750, 3415000, 20000, 0.03, 0.59, 0.35],
                [14, 505000, 160000, 182750, 3495000, 100000, 0.14, 2.86, 1.72],
                [15, 445000, 160000, 185750, 3555000, 160000, 0.23, 4.50, 2.70],
                [16, 380000, 160000, 189000, 3620000, 225000, 0.31, 6.22, 3.73],
                [17, 320000, 160000, 192000, 3680000, 285000, 0.39, 7.74, 4.65],
                [18, 260000, 160000, 195000, 3740000, 345000, 0.46, 9.22, 5.53],
                [19, 200000, 160000, 198000, 3800000, 405000, 0.53, 10.66, 6.39],
                [20, 0, 160000, 200000, 3840000, 445000, 0.58, 11.59, 6.95]
            ];
            
            document.getElementById('emiMonthlyPaid').textContent = 'тВ╣1,44,500';
            generateDetailedAnalysis();
        }

        function toggleEdit() {
            editMode = !editMode;
            const btn = document.getElementById('editBtn');
            btn.textContent = editMode ? 'ЁЯТ╛ Save' : 'тЬПя╕П Edit';
            btn.style.background = editMode ? '#38a169' : '#667eea';
            generateDetailedAnalysis(); // Refresh table with edit mode
        }

        function updateData(rowIndex, colIndex, value) {
            detailedAnalysisData[rowIndex][colIndex] = parseFloat(value) || 0;
            
            const row = detailedAnalysisData[rowIndex];
            const chitAmount = parseFloat(document.getElementById('analysisChitAmount').value.replace(/,/g, '')) || 4000000;
            const auctionAmount = parseFloat(document.getElementById('analysisAuctionAmount').value.replace(/,/g, '')) || 200000;
            const totalMonths = parseInt(document.getElementById('analysisTotalMonths').value) || 20;
            
            // Recalculate values for this specific row only
            const totalDividend = row[1] - row[2]; // Bid Amount - Commission
            const dividendPerPerson = totalDividend / totalMonths;
            const calculatedPayable = auctionAmount - dividendPerPerson;
            row[3] = Math.max(0, Math.min(calculatedPayable, auctionAmount)); // Payable Installment
            row[4] = chitAmount - row[1]; // Bidder Gets
            
            // Calculate profit/loss using actual total payable from all months
            const totalPayableSum = detailedAnalysisData.reduce((sum, r) => sum + r[3], 0);
            row[5] = row[4] - totalPayableSum; // Profit/Loss
            
            if (row[4] > 0) {
                row[7] = (row[5] / row[4]) * 100; // Total Percentage
                row[6] = row[7] / totalMonths; // Monthly %
                row[8] = row[6] * 12; // Annual Rate
            } else {
                row[6] = row[7] = row[8] = 0;
            }
            
            generateDetailedAnalysis(); // Refresh display
        }

        function clearAnalysisData() {
            if (confirm('Clear all analysis data?')) {
                document.getElementById('analysisBody').innerHTML = '<tr><td colspan="9" style="text-align: center; padding: 40px;">Data cleared. Enter values and click Submit.</td></tr>';
                document.getElementById('totalPayable').textContent = 'тВ╣0';

                document.getElementById('emiMonthlyPaid').textContent = 'тВ╣0';
            }
        }

        function fetchToBestMonth() {
            // If no data, load sample data
            if (detailedAnalysisData.length === 0) {
                loadSampleData();
            }
            
            // Switch to Best Month tab
            showTab('comparison');
            
            // Generate comparison
            setTimeout(() => {
                generateComparison();
                alert('Data fetched to Best Month tab successfully!');
            }, 100);
        }

        function generateAnalysis() {
            submitValues();
        }

        function analyzeCurrentData() {
            // If no data, load sample data first
            if (detailedAnalysisData.length === 0) {
                detailedAnalysisData = [
                    [1, 1270000, 160000, 144500, 2730000, -665000, -1.22, -24.36, -14.62],
                    [2, 1320000, 160000, 142000, 2680000, -715000, -1.33, -26.68, -16.01],
                    [3, 1295000, 160000, 143250, 2705000, -690000, -1.28, -25.51, -15.30],
                    [4, 1290000, 160000, 143500, 2710000, -685000, -1.26, -25.28, -15.17],
                    [5, 1220000, 160000, 147000, 2780000, -615000, -1.11, -22.12, -13.27],
                    [6, 1150000, 160000, 150500, 2850000, -545000, -0.96, -19.12, -11.47],
                    [7, 1020000, 160000, 157000, 2980000, -415000, -0.70, -13.93, -8.36],
                    [8, 910000, 160000, 162500, 3090000, -305000, -0.49, -9.87, -5.92],
                    [9, 800000, 160000, 168000, 3200000, -195000, -0.30, -6.09, -3.66],
                    [10, 755000, 160000, 170250, 3245000, -150000, -0.23, -4.62, -2.77],
                    [11, 730000, 160000, 171500, 3270000, -125000, -0.19, -3.82, -2.29],
                    [12, 685000, 160000, 173750, 3315000, -80000, -0.12, -2.41, -1.45],
                    [13, 585000, 160000, 178750, 3415000, 20000, 0.03, 0.59, 0.35],
                    [14, 505000, 160000, 182750, 3495000, 100000, 0.14, 2.86, 1.72],
                    [15, 445000, 160000, 185750, 3555000, 160000, 0.23, 4.50, 2.70],
                    [16, 380000, 160000, 189000, 3620000, 225000, 0.31, 6.22, 3.73],
                    [17, 320000, 160000, 192000, 3680000, 285000, 0.39, 7.74, 4.65],
                    [18, 260000, 160000, 195000, 3740000, 345000, 0.46, 9.22, 5.53],
                    [19, 200000, 160000, 198000, 3800000, 405000, 0.53, 10.66, 6.39],
                    [20, 0, 160000, 200000, 3840000, 445000, 0.58, 11.59, 6.95]
                ];
            }
            generateComparison();
        }

        function loadProfitAnalysis() {
            const tbody = document.getElementById('comparisonBody');
            
            if (detailedAnalysisData.length === 0) {
                loadSampleData();
            }
            
            const externalRate = parseFloat(document.getElementById('externalRate').value) || 12;
            const totalMonths = parseInt(document.getElementById('analysisTotalMonths').value) || 20;
            
            // Calculate rankings
            const monthlyRates = detailedAnalysisData.map((row, index) => {
                const month = row[0];
                const receivedAmount = row[4];
                const chitProfit = row[5];
                const remainingMonths = totalMonths - month;
                const externalInterest = receivedAmount * (externalRate / 100) * (remainingMonths / 12);
                const totalBenefit = chitProfit + externalInterest;
                const dynamicTotalPercentage = receivedAmount > 0 ? (totalBenefit / receivedAmount) * 100 : 0;
                const dynamicMonthlyRate = dynamicTotalPercentage / totalMonths;
                return { index, month, dynamicMonthlyRate, totalBenefit };
            });
            
            const sortedRates = [...monthlyRates].sort((a, b) => b.dynamicMonthlyRate - a.dynamicMonthlyRate);
            let bestMonth = sortedRates[0].month;
            let maxProfit = sortedRates[0].totalBenefit;
            
            tbody.innerHTML = detailedAnalysisData.map((row, index) => {
                const month = row[0];
                const bidAmount = row[1];
                const receivedAmount = row[4];
                const chitProfit = row[5];
                
                const remainingMonths = totalMonths - month;
                const externalInterest = receivedAmount * (externalRate / 100) * (remainingMonths / 12);
                const externalBenefitPercentage = receivedAmount > 0 ? (externalInterest / receivedAmount) * 100 : 0;
                const totalBenefit = chitProfit + externalInterest;
                const dynamicTotalPercentage = receivedAmount > 0 ? (totalBenefit / receivedAmount) * 100 : 0;
                const dynamicMonthlyRate = dynamicTotalPercentage / totalMonths;
                const dynamicAnnualRate = dynamicMonthlyRate * 12;
                
                const rank = sortedRates.findIndex(item => item.month === month) + 1;
                
                let recommendation = '';
                let rankColor = '';
                if (rank <= 4) {
                    recommendation = 'ЁЯПЖ Rank ' + rank;
                    rankColor = 'background: #d4edda; color: #155724;';
                } else if (rank <= 8) {
                    recommendation = 'ЁЯеИ Rank ' + rank;
                    rankColor = 'background: #d1ecf1; color: #0c5460;';
                } else {
                    recommendation = 'ЁЯеЙ Rank ' + rank;
                    rankColor = 'background: #ffeaa7; color: #856404;';
                }
                
                return `
                    <tr style="${month === bestMonth ? 'background: #fff3cd; font-weight: bold;' : ''}">
                        <td>${month}</td>
                        <td>тВ╣${new Intl.NumberFormat('en-IN').format(bidAmount)}</td>
                        <td>тВ╣${new Intl.NumberFormat('en-IN').format(receivedAmount)}</td>
                        <td class="${chitProfit >= 0 ? 'profit' : 'loss'}">тВ╣${new Intl.NumberFormat('en-IN').format(chitProfit)}</td>
                        <td class="profit">тВ╣${new Intl.NumberFormat('en-IN').format(Math.round(externalInterest))}</td>
                        <td class="profit">${externalBenefitPercentage.toFixed(2)}%</td>
                        <td class="${totalBenefit >= 0 ? 'profit' : 'loss'}">тВ╣${new Intl.NumberFormat('en-IN').format(Math.round(totalBenefit))}</td>
                        <td class="${dynamicTotalPercentage >= 0 ? 'profit' : 'loss'}">${dynamicTotalPercentage.toFixed(2)}%</td>
                        <td class="${dynamicMonthlyRate >= 0 ? 'profit' : 'loss'}">${dynamicMonthlyRate.toFixed(2)}%</td>
                        <td class="${dynamicAnnualRate >= 0 ? 'profit' : 'loss'}">${dynamicAnnualRate.toFixed(2)}%</td>
                        <td style="${rankColor} padding: 4px; border-radius: 4px; font-weight: bold;">${recommendation}</td>
                    </tr>
                `;
            }).join('');
            
            document.getElementById('bestMonth').textContent = bestMonth;
            document.getElementById('maxBenefit').textContent = `Maximum Profit: тВ╣${new Intl.NumberFormat('en-IN').format(Math.round(maxProfit))}`;
        }
        
        function generateComparison() {
            loadProfitAnalysis();
        }

        function shareResult() {
            const result = `Chit Fund Calculation:
Bidding Rate: ${document.getElementById('biddingRate').textContent}
Amount Received: ${document.getElementById('amountReceived').textContent}
Net Installment: ${document.getElementById('netInstallment').textContent}
Monthly Savings: ${document.getElementById('savingsPercentage').textContent}`;
            
            if (navigator.share) {
                navigator.share({ title: 'Chit Fund Calculator', text: result });
            } else {
                navigator.clipboard.writeText(result);
                alert('Result copied to clipboard!');
            }
        }

        function shareAsImage() {
            const canvas = document.createElement('canvas');
            const ctx = canvas.getContext('2d');
            canvas.width = 400;
            canvas.height = 500;
            
            ctx.fillStyle = '#667eea';
            ctx.fillRect(0, 0, canvas.width, canvas.height);
            
            ctx.fillStyle = 'white';
            ctx.font = 'bold 24px Arial';
            ctx.textAlign = 'center';
            ctx.fillText('Chit Fund Calculator', canvas.width/2, 40);
            
            ctx.font = '14px Arial';
            ctx.textAlign = 'left';
            const results = [
                `Bidding Rate: ${document.getElementById('biddingRate').textContent}`,
                `Amount Received: ${document.getElementById('amountReceived').textContent}`,
                `Net Installment: ${document.getElementById('netInstallment').textContent}`,
                `Monthly Savings: ${document.getElementById('savingsPercentage').textContent}`
            ];
            
            results.forEach((text, index) => {
                ctx.fillText(text, 20, 100 + (index * 30));
            });
            
            canvas.toBlob(blob => {
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = 'chit-calculation.png';
                a.click();
                URL.revokeObjectURL(url);
                alert('Image downloaded!');
            });
        }

        function saveResult() {
            localStorage.setItem('chitResult_' + Date.now(), JSON.stringify({
                biddingRate: document.getElementById('biddingRate').textContent,
                amountReceived: document.getElementById('amountReceived').textContent,
                netInstallment: document.getElementById('netInstallment').textContent
            }));
            alert('Result saved!');
        }

        function exportPDF() {
            window.print();
        }

        function exportCSV() {
            if (detailedAnalysisData.length === 0) {
                alert('Please generate analysis first!');
                return;
            }
            
            let csv = 'Month,BID Amount,Dealer Commission,Payable Installment,Bidder Gets,Profit/Loss,Monthly %,Total Percentage,Annual Rate\n';
            detailedAnalysisData.forEach(row => {
                csv += `${row[0]},${row[1]},${row[2]},${row[3]},${row[4]},${row[5]},${row[6].toFixed(2)}%,${row[7].toFixed(2)}%,${row[8].toFixed(2)}%\n`;
            });
            
            const blob = new Blob([csv], { type: 'text/csv' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'chit_analysis.csv';
            a.click();
            URL.revokeObjectURL(url);
        }

        function downloadBestMonthCSV() {
            if (detailedAnalysisData.length === 0) {
                loadSampleData();
            }
            
            const externalRate = parseFloat(document.getElementById('externalRate').value) || 12;
            let csv = 'Month,Bid Amount,Received Amount,Chit Profit/Loss,External Interest,Total Benefit,Total Percentage,Monthly Rate,Annual Rate,Recommendation\n';
            
            const totalMonths = parseInt(document.getElementById('analysisTotalMonths').value) || 20;
            const comparisonData = detailedAnalysisData.map(row => {
                const month = row[0];
                const bidAmount = row[1];
                const amountReceived = row[4];
                const chitBenefit = row[5];
                const remainingMonths = totalMonths - month;
                const externalBenefit = amountReceived * (externalRate / 100) * (remainingMonths / 12);
                const totalBenefit = chitBenefit + externalBenefit;
                const totalPercentage = amountReceived > 0 ? (totalBenefit / amountReceived) * 100 : 0;
                const monthlyRate = totalPercentage / totalMonths;
                const annualRate = monthlyRate * 12;
                return { month, bidAmount, amountReceived, chitBenefit, externalBenefit, totalBenefit, totalPercentage, monthlyRate, annualRate };
            });

            comparisonData.sort((a, b) => b.totalBenefit - a.totalBenefit);
            
            comparisonData.forEach((row, index) => {
                const rank = index < 5 ? 'ЁЯПЖ' : index < 10 ? 'ЁЯеИ' : 'ЁЯеЙ';
                csv += `${row.month},${row.bidAmount},${row.amountReceived},${row.chitBenefit},${row.externalBenefit.toFixed(0)},${row.totalBenefit.toFixed(0)},${row.totalPercentage.toFixed(2)}%,${row.monthlyRate.toFixed(2)}%,${row.annualRate.toFixed(2)}%,${rank} Rank ${index + 1}\n`;
            });
            
            const blob = new Blob([csv], { type: 'text/csv' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `Best_Month_Analysis_${externalRate}percent.csv`;
            a.click();
            URL.revokeObjectURL(url);
        }

        function downloadBestMonthPDF() {
            window.print();
        }

        function downloadBestMonthExcel() {
            if (detailedAnalysisData.length === 0) {
                alert('Please generate analysis data first!');
                return;
            }
            
            const externalRate = parseFloat(document.getElementById('externalRate').value) || 12;
            let excelContent = '<table border="1">';
            excelContent += '<tr><th>Month</th><th>Bid Amount</th><th>Received Amount</th><th>Chit Profit/Loss</th><th>External Interest</th><th>Total Benefit</th><th>Total Percentage</th><th>Monthly Rate</th><th>Annual Rate</th><th>Recommendation</th></tr>';
            
            const comparisonData = detailedAnalysisData.map(row => {
                const month = row[0];
                const bidAmount = row[1];
                const amountReceived = row[4];
                const chitBenefit = row[5];
                const remainingMonths = 20 - month;
                const externalBenefit = amountReceived * (externalRate / 100) * (remainingMonths / 12);
                const totalBenefit = chitBenefit + externalBenefit;
                const totalPercentage = amountReceived > 0 ? (totalBenefit / amountReceived) * 100 : 0;
                const monthlyRate = totalPercentage / 20;
                const annualRate = monthlyRate * 12;
                return { month, bidAmount, amountReceived, chitBenefit, externalBenefit, totalBenefit, totalPercentage, monthlyRate, annualRate };
            });

            comparisonData.sort((a, b) => b.totalBenefit - a.totalBenefit);
            
            comparisonData.forEach((row, index) => {
                const rank = index < 5 ? 'ЁЯПЖ' : index < 10 ? 'ЁЯеИ' : 'ЁЯеЙ';
                excelContent += `<tr><td>${row.month}</td><td>${row.bidAmount}</td><td>${row.amountReceived}</td><td>${row.chitBenefit}</td><td>${row.externalBenefit.toFixed(0)}</td><td>${row.totalBenefit.toFixed(0)}</td><td>${row.totalPercentage.toFixed(2)}%</td><td>${row.monthlyRate.toFixed(2)}%</td><td>${row.annualRate.toFixed(2)}%</td><td>${rank} Rank ${index + 1}</td></tr>`;
            });
            
            excelContent += '</table>';
            
            const blob = new Blob([excelContent], { type: 'application/vnd.ms-excel' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `Best_Month_Analysis_${externalRate}percent.xls`;
            a.click();
            URL.revokeObjectURL(url);
        }

        // Event listeners
        document.querySelectorAll('input[name="bidType"]').forEach(radio => {
            radio.addEventListener('change', toggleBidType);
        });

        document.getElementById('bidAmountSlider').addEventListener('input', function() {
            document.getElementById('bidAmount').value = new Intl.NumberFormat('en-IN').format(this.value);
            calculate();
        });

        document.getElementById('bidRateSlider').addEventListener('input', function() {
            document.getElementById('bidRate').value = this.value;
            calculate();
        });

        // Auto-calculate on input changes
        ['chitAmount', 'totalMonths', 'commission', 'monthlyInstallment', 'currentMonth', 'bidAmount', 'bidRate'].forEach(id => {
            document.getElementById(id).addEventListener('input', calculate);
        });

        // Initialize
        calculate();
        updateTexts();
        
        // Auto-generate dynamic data for Best Month tab
        function generateDynamicData() {
            // Use Analysis tab values if available, otherwise Calculator tab values
            const chitAmount = parseFloat(document.getElementById('analysisChitAmount').value.replace(/,/g, '')) || 
                              parseFloat(document.getElementById('chitAmount').value.replace(/,/g, '')) || 4000000;
            const commissionPercent = parseFloat(document.getElementById('analysisCommission').value) || 
                                     parseFloat(document.getElementById('commission').value) || 4;
            const monthlyInstallment = parseFloat(document.getElementById('analysisAuctionAmount').value.replace(/,/g, '')) || 
                                      parseFloat(document.getElementById('monthlyInstallment').value.replace(/,/g, '')) || 200000;
            const totalMonths = parseInt(document.getElementById('analysisTotalMonths').value) || 
                               parseInt(document.getElementById('totalMonths').value) || 20;
            
            const dealerCommission = (commissionPercent * chitAmount) / 100;
            
            detailedAnalysisData = [];
            for (let month = 1; month <= totalMonths; month++) {
                const bidAmount = Math.max(0, 1500000 - (month * 60000));
                const bidderGets = chitAmount - bidAmount;
                const totalDividend = bidAmount - dealerCommission;
                const dividendPerPerson = totalDividend / totalMonths; // Dynamic members based on total months
                const payableInstallment = Math.max(0, bidderGets - dividendPerPerson); // Subtract from bidder gets
                detailedAnalysisData.push([month, bidAmount, dealerCommission, payableInstallment, bidderGets, 0, 0, 0, 0]);
            }
            
            // Calculate profit/loss for each month after all payable installments are calculated
            const totalPayableSum = detailedAnalysisData.reduce((sum, row) => sum + row[3], 0);
            for (let i = 0; i < detailedAnalysisData.length; i++) {
                const profitLoss = detailedAnalysisData[i][4] - totalPayableSum;
                const totalPercentage = detailedAnalysisData[i][4] > 0 ? (profitLoss / detailedAnalysisData[i][4]) * 100 : 0;
                const monthlyRate = totalPercentage / totalMonths;
                const annualRate = monthlyRate * 12;
                
                detailedAnalysisData[i][5] = profitLoss;
                detailedAnalysisData[i][6] = monthlyRate;
                detailedAnalysisData[i][7] = totalPercentage;
                detailedAnalysisData[i][8] = annualRate;
            }
        }
        
        if (detailedAnalysisData.length === 0) {
            generateDynamicData();
        }
    </script>
</body>
</html>